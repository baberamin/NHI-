<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saviynt NHI Security Platform</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            min-height: 100vh;
            color: #e2e8f0;
            line-height: 1.6;
        }
        
        /* Persona Selector Styles */
        .persona-selector-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 32px;
        }
        
        .persona-selector {
            text-align: center;
            max-width: 900px;
            width: 100%;
        }
        
        .persona-selector h1 {
            font-size: 48px;
            margin-bottom: 16px;
            color: #ffffff;
            text-shadow: 0 2px 8px rgba(0, 188, 212, 0.3);
        }
        
        .persona-selector-subtitle {
            font-size: 20px;
            color: #94a3b8;
            margin-bottom: 56px;
            line-height: 1.6;
        }
        
        .persona-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 40px;
            margin-top: 48px;
        }
        
        .persona-card {
            background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
            border: 2px solid #334155;
            border-radius: 16px;
            padding: 48px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .persona-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #00BCD4 0%, #00A9CE 100%);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .persona-card:hover {
            border-color: #00BCD4;
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0, 188, 212, 0.3);
        }
        
        .persona-card:hover::before {
            transform: scaleX(1);
        }
        
        .persona-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        .persona-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
            color: #ffffff;
        }
        
        .persona-role {
            font-size: 16px;
            color: #00BCD4;
            margin-bottom: 24px;
            font-weight: 600;
        }
        
        .persona-features {
            list-style: none;
            text-align: left;
            margin-top: 20px;
        }
        
        .persona-features li {
            padding: 10px 0;
            color: #94a3b8;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .persona-features li::before {
            content: '✓ ';
            color: #00BCD4;
            font-weight: bold;
            margin-right: 8px;
        }
        
        /* Main Dashboard Styles */
        .dashboard-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 30px;
        }
        
        .dashboard-nav {
            background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 20px 28px;
            margin-bottom: 28px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dashboard-nav-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .saviynt-logo {
            font-size: 24px;
            font-weight: bold;
            color: #00BCD4;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .saviynt-mascot {
            font-size: 32px;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .persona-badge {
            background: rgba(0, 188, 212, 0.1);
            border: 1px solid #00BCD4;
            color: #00BCD4;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .switch-persona-btn {
            background: transparent;
            border: 1px solid #475569;
            color: #94a3b8;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .switch-persona-btn:hover {
            border-color: #00BCD4;
            color: #00BCD4;
        }
        
        .reset-simulation-btn {
            background: rgba(230, 57, 70, 0.1);
            border: 1px solid #E63946;
            color: #E63946;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            font-weight: 600;
        }
        
        .reset-simulation-btn:hover {
            background: rgba(230, 57, 70, 0.2);
            border-color: #ff5a5f;
            color: #ff5a5f;
        }
        
        .nhi-ratio-badge {
            background: rgba(0, 188, 212, 0.1);
            border: 1px solid #00BCD4;
            color: #00BCD4;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
        }
        
        .toast-notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
            border: 2px solid #00C48C;
            border-radius: 12px;
            padding: 20px 24px;
            min-width: 300px;
            max-width: 400px;
            box-shadow: 0 8px 24px rgba(0, 196, 140, 0.3);
            z-index: 10000;
            animation: slideIn 0.3s ease-out;
        }
        
        .toast-notification.error {
            border-color: #E63946;
            box-shadow: 0 8px 24px rgba(230, 57, 70, 0.3);
        }
        
        .toast-notification.warning {
            border-color: #FF6B35;
            box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
        
        .toast-notification.hiding {
            animation: slideOut 0.3s ease-in forwards;
        }
        
        .toast-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }
        
        .toast-icon {
            font-size: 24px;
        }
        
        .toast-title {
            font-size: 16px;
            font-weight: 700;
            color: #fff;
        }
        
        .toast-message {
            font-size: 14px;
            color: #94a3b8;
            line-height: 1.6;
        }
        
        .toast-close {
            position: absolute;
            top: 12px;
            right: 12px;
            background: transparent;
            border: none;
            color: #64748b;
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s;
        }
        
        .toast-close:hover {
            color: #fff;
        }
        
        .dashboard-header {
            background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 28px;
        }
        
        .dashboard-header h1 {
            color: #ffffff;
            font-size: 28px;
            margin-bottom: 12px;
            line-height: 1.3;
        }
        
        .dashboard-header p {
            color: #94a3b8;
            font-size: 14px;
            line-height: 1.7;
        }
        
        .controls {
            display: flex;
            gap: 24px;
            margin-top: 24px;
            flex-wrap: wrap;
        }
        
        .control-group {
            flex: 1;
            min-width: 200px;
        }
        
        .control-group label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #94a3b8;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .control-group select,
        .control-group input {
            width: 100%;
            padding: 10px;
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 6px;
            font-size: 14px;
            color: #e2e8f0;
            transition: border-color 0.2s;
        }
        
        .control-group select:focus,
        .control-group input:focus {
            outline: none;
            border-color: #00BCD4;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 28px;
            margin-bottom: 28px;
        }
        
        .grid-full {
            display: grid;
            grid-template-columns: 1fr;
            gap: 28px;
            margin-bottom: 28px;
        }
        
        .card {
            background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 32px;
        }
        
        .card-title {
            font-size: 14px;
            font-weight: 600;
            color: #94a3b8;
            margin-bottom: 24px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Risk Dial Styles */
        .risk-dial-container {
            position: relative;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .risk-dial {
            position: relative;
            width: 200px;
            height: 200px;
        }
        
        .dial-background {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                from 180deg,
                #00C48C 0%,
                #00C48C 33%,
                #FF6B35 33%,
                #FF6B35 66%,
                #E63946 66%,
                #E63946 100%
            );
        }
        
        .dial-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 160px;
            height: 160px;
            border-radius: 50%;
            background: #0f172a;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
        }
        
        .dial-value {
            font-size: 32px;
            font-weight: bold;
            color: #ffffff;
        }
        
        .dial-label {
            font-size: 12px;
            color: #94a3b8;
            margin-top: 4px;
        }
        
        .dial-needle {
            position: absolute;
            bottom: 50%;
            left: 50%;
            transform-origin: bottom center;
            width: 3px;
            height: 90px;
            background: #ffffff;
            border-radius: 3px;
            transition: transform 0.5s ease;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .risk-summary {
            margin-top: 24px;
            padding: 20px;
            background: rgba(0, 188, 212, 0.05);
            border: 1px solid rgba(0, 188, 212, 0.2);
            border-radius: 8px;
        }
        
        .risk-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .risk-row:last-child {
            margin-bottom: 0;
        }
        
        .risk-label {
            color: #94a3b8;
        }
        
        .risk-value {
            font-weight: 600;
            color: #ffffff;
        }
        
        /* Button Styles */
        .toggle-button,
        .action-button {
            width: 100%;
            padding: 12px 20px;
            background: linear-gradient(135deg, #00BCD4 0%, #00A9CE 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 20px;
        }
        
        .toggle-button:hover,
        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 188, 212, 0.4);
        }
        
        .action-button.secondary {
            background: linear-gradient(135deg, #334155 0%, #1e293b 100%);
        }
        
        .action-button.danger {
            background: linear-gradient(135deg, #E63946 0%, #C92A2A 100%);
        }
        
        /* Threat Intelligence Feed */
        .ti-feed {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .ti-feed::-webkit-scrollbar {
            width: 6px;
        }
        
        .ti-feed::-webkit-scrollbar-track {
            background: #0f172a;
        }
        
        .ti-feed::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 3px;
        }
        
        .ti-alert {
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            border-left: 4px solid;
            animation: slideIn 0.3s ease;
            background: rgba(0, 0, 0, 0.3);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .ti-alert.critical {
            border-color: #E63946;
            background: rgba(230, 57, 70, 0.1);
        }
        
        .ti-alert.high {
            border-color: #FF6B35;
            background: rgba(255, 107, 53, 0.1);
        }
        
        .ti-alert.medium {
            border-color: #00BCD4;
            background: rgba(0, 188, 212, 0.1);
        }
        
        .ti-alert-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }
        
        .ti-alert-title {
            font-weight: 600;
            font-size: 13px;
            color: #ffffff;
        }
        
        .ti-alert-severity {
            font-size: 11px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 4px;
            text-transform: uppercase;
        }
        
        .ti-alert.critical .ti-alert-severity {
            background: #E63946;
            color: white;
        }
        
        .ti-alert.high .ti-alert-severity {
            background: #FF6B35;
            color: white;
        }
        
        .ti-alert.medium .ti-alert-severity {
            background: #00BCD4;
            color: #0f172a;
        }
        
        .ti-alert-body {
            font-size: 12px;
            color: #94a3b8;
            margin-bottom: 10px;
            line-height: 1.7;
        }
        
        .ti-alert-impact {
            font-size: 12px;
            font-weight: 600;
            color: #E63946;
        }
        
        /* Metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .metric {
            padding: 20px;
            background: rgba(0, 188, 212, 0.05);
            border: 1px solid rgba(0, 188, 212, 0.2);
            border-radius: 8px;
        }
        
        .metric-label {
            font-size: 12px;
            color: #94a3b8;
            margin-bottom: 12px;
            line-height: 1.5;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #ffffff;
        }
        
        .metric-trend {
            font-size: 12px;
            margin-top: 4px;
        }
        
        .metric-trend.up {
            color: #E63946;
        }
        
        .metric-trend.down {
            color: #00C48C;
        }
        
        /* Security Maturity Styles */
        .maturity-container {
            background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
            border: 2px solid #00BCD4;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 28px;
        }
        
        .maturity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 28px;
        }
        
        .maturity-level {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .maturity-icon {
            font-size: 48px;
        }
        
        .maturity-info h2 {
            font-size: 24px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 4px;
        }
        
        .maturity-info p {
            font-size: 14px;
            color: #94a3b8;
        }
        
        .maturity-rank {
            text-align: right;
        }
        
        .maturity-rank-number {
            font-size: 32px;
            font-weight: 700;
            color: #00BCD4;
            line-height: 1;
            margin-bottom: 4px;
        }
        
        .maturity-rank-label {
            font-size: 12px;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .maturity-progress-section {
            margin-bottom: 24px;
        }
        
        .maturity-progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        
        .maturity-progress-label {
            font-size: 14px;
            font-weight: 600;
            color: #94a3b8;
        }
        
        .maturity-progress-value {
            font-size: 16px;
            font-weight: 700;
            color: #00BCD4;
        }
        
        .maturity-progress-bar {
            height: 12px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid #334155;
        }
        
        .maturity-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00BCD4 0%, #00C48C 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
        }
        
        .maturity-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        .maturity-stat {
            text-align: center;
            padding: 16px;
            background: rgba(0, 188, 212, 0.05);
            border: 1px solid rgba(0, 188, 212, 0.2);
            border-radius: 8px;
        }
        
        .maturity-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #fff;
            margin-bottom: 4px;
        }
        
        .maturity-stat-label {
            font-size: 11px;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Table Styles */
        .data-table {
            width: 100%;
            font-size: 13px;
        }
        
        .data-table th {
            text-align: left;
            padding: 12px 8px;
            border-bottom: 2px solid #334155;
            color: #94a3b8;
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .data-table td {
            padding: 12px 8px;
            border-bottom: 1px solid #1e293b;
            color: #e2e8f0;
        }
        
        .data-table tr:hover {
            background: rgba(0, 188, 212, 0.05);
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }
        
        .status-badge.critical {
            background: rgba(230, 57, 70, 0.2);
            color: #E63946;
            border: 1px solid #E63946;
        }
        
        .status-badge.high {
            background: rgba(255, 107, 53, 0.2);
            color: #FF6B35;
            border: 1px solid #FF6B35;
        }
        
        .status-badge.medium {
            background: rgba(0, 188, 212, 0.2);
            color: #00BCD4;
            border: 1px solid #00BCD4;
        }
        
        .status-badge.low {
            background: rgba(0, 196, 140, 0.2);
            color: #00C48C;
            border: 1px solid #00C48C;
        }
        
        /* Recommendations */
        .recommendations-container {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .recommendation {
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            margin-bottom: 16px;
            border-left: 4px solid #00BCD4;
            transition: all 0.2s;
        }
        
        .recommendation.applied {
            background: rgba(0, 196, 140, 0.1);
            border-color: #00C48C;
            opacity: 0.7;
        }
        
        .recommendation:hover:not(.applied) {
            background: rgba(0, 188, 212, 0.1);
            transform: translateX(4px);
        }
        
        .recommendation-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 16px;
        }
        
        .recommendation-title {
            font-weight: 600;
            font-size: 14px;
            color: #ffffff;
            flex: 1;
        }
        
        .recommendation-priority {
            font-size: 11px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            margin-left: 12px;
        }
        
        .recommendation-priority.critical {
            background: #E63946;
            color: white;
        }
        
        .recommendation-priority.high {
            background: #FF6B35;
            color: white;
        }
        
        .recommendation-priority.medium {
            background: #00BCD4;
            color: #0f172a;
        }
        
        .recommendation-body {
            font-size: 13px;
            color: #94a3b8;
            margin-bottom: 16px;
            line-height: 1.7;
        }
        
        .recommendation-metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 16px;
        }
        
        .recommendation-metric {
            text-align: center;
            padding: 12px;
            background: rgba(0, 188, 212, 0.05);
            border: 1px solid rgba(0, 188, 212, 0.2);
            border-radius: 6px;
        }
        
        .recommendation-metric-label {
            font-size: 11px;
            color: #94a3b8;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .recommendation-metric-value {
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
        }
        
        .recommendation-metric-value.positive {
            color: #00C48C;
        }
        
        .recommendation-actions {
            display: flex;
            gap: 12px;
        }
        
        .apply-button {
            flex: 1;
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .apply-button.primary {
            background: linear-gradient(135deg, #00C48C 0%, #00A067 100%);
            color: white;
        }
        
        .apply-button.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 196, 140, 0.4);
        }
        
        .apply-button.secondary {
            background: #334155;
            color: #94a3b8;
        }
        
        .apply-button.ai {
            background: linear-gradient(135deg, #00BCD4 0%, #00A9CE 100%);
            color: white;
            position: relative;
        }
        
        .apply-button.ai:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 188, 212, 0.4);
        }
        
        .apply-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Saviynt AI Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.2s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal {
            background: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
            border: 2px solid #00BCD4;
            border-radius: 16px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 188, 212, 0.3);
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 28px;
            padding-bottom: 20px;
            border-bottom: 2px solid #334155;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: #ffffff;
            flex: 1;
        }
        
        .modal-close {
            background: transparent;
            border: none;
            color: #94a3b8;
            font-size: 24px;
            cursor: pointer;
            padding: 4px 8px;
            line-height: 1;
        }
        
        .modal-close:hover {
            color: #E63946;
        }
        
        .ai-agent-status {
            background: rgba(0, 188, 212, 0.1);
            border: 1px solid #00BCD4;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 24px;
        }
        
        .ai-step {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 0;
            border-bottom: 1px solid rgba(51, 65, 85, 0.5);
        }
        
        .ai-step:last-child {
            border-bottom: none;
        }
        
        .ai-step-icon {
            font-size: 20px;
        }
        
        .ai-step-text {
            flex: 1;
            font-size: 14px;
            color: #e2e8f0;
            line-height: 1.6;
        }
        
        .ai-step.completed {
            color: #00C48C;
        }
        
        .ai-step.in-progress {
            color: #00BCD4;
        }
        
        .ai-step.pending {
            color: #64748b;
        }
        
        .rollback-risk {
            background: rgba(230, 57, 70, 0.1);
            border: 1px solid #E63946;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .rollback-risk-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            font-weight: 600;
            color: #E63946;
        }
        
        .rollback-risk-details {
            font-size: 13px;
            color: #94a3b8;
            line-height: 1.6;
        }
        
        .rollback-risk-details li {
            margin-bottom: 4px;
        }
        
        /* IT Admin Specific Styles */
        .action-queue {
            display: grid;
            gap: 12px;
        }
        
        .queue-section {
            border: 1px solid;
            border-radius: 8px;
            padding: 16px;
        }
        
        .queue-section.urgent {
            border-color: #E63946;
            background: rgba(230, 57, 70, 0.05);
        }
        
        .queue-section.due-soon {
            border-color: #FF6B35;
            background: rgba(255, 107, 53, 0.05);
        }
        
        .queue-section.scheduled {
            border-color: #00C48C;
            background: rgba(0, 196, 140, 0.05);
        }
        
        .queue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .queue-title {
            font-weight: 600;
            font-size: 14px;
        }
        
        .queue-count {
            font-size: 18px;
            font-weight: bold;
        }
        
        .queue-items {
            font-size: 13px;
            color: #94a3b8;
            line-height: 1.8;
        }
        
        .system-status-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            margin-bottom: 8px;
        }
        
        .system-status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .system-status-indicator.healthy {
            background: #00C48C;
            box-shadow: 0 0 10px rgba(0, 196, 140, 0.5);
        }
        
        .system-status-indicator.warning {
            background: #FF6B35;
            box-shadow: 0 0 10px rgba(255, 107, 53, 0.5);
        }
        
        .system-status-indicator.error {
            background: #E63946;
            box-shadow: 0 0 10px rgba(230, 57, 70, 0.5);
        }
        
        .progress-bar {
            width: 100%;
            height: 24px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            overflow: hidden;
            margin: 12px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00BCD4 0%, #00C48C 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: 600;
        }
        
        .health-score {
            font-size: 48px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
        }
        
        .health-score.excellent {
            color: #00C48C;
        }
        
        .health-score.good {
            color: #00BCD4;
        }
        
        .health-score.fair {
            color: #FF6B35;
        }
        
        .health-score.poor {
            color: #E63946;
        }
        
        .chart-container {
            position: relative;
            height: 250px;
            margin-top: 20px;
        }
        
        .impact-summary {
            background: linear-gradient(135deg, #00BCD4 0%, #00A9CE 100%);
            color: white;
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 24px;
        }
        
        .impact-summary-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 16px;
            opacity: 0.9;
        }
        
        .impact-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        .impact-stat {
            text-align: center;
        }
        
        .impact-stat-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 6px;
        }
        
        .impact-stat-label {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .ciso-feed-item {
            padding: 16px;
            background: rgba(0, 196, 140, 0.1);
            border-left: 3px solid #00C48C;
            border-radius: 6px;
            margin-bottom: 12px;
            font-size: 13px;
            line-height: 1.6;
        }
        
        .ciso-feed-item strong {
            color: #00C48C;
        }
        
        .ciso-feed-item .timestamp {
            color: #64748b;
            font-size: 11px;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Data structures
        const industries = {
            banking: {
                name: "Banking & Financial Services",
                riskMetric: "Fraud Loss Exposure",
                currency: "$",
                suffix: "M",
                description: "Risk expressed as potential fraud loss in millions"
            },
            healthcare: {
                name: "Healthcare",
                riskMetric: "HIPAA Breach Risk",
                currency: "$",
                suffix: "M",
                description: "Risk expressed as potential HIPAA fines and breach costs"
            },
            retail: {
                name: "Retail & E-commerce",
                riskMetric: "Revenue at Risk",
                currency: "$",
                suffix: "M",
                description: "Peak season revenue exposure from downtime/breach"
            },
            manufacturing: {
                name: "Manufacturing",
                riskMetric: "Production Loss Risk",
                currency: "$",
                suffix: "M",
                description: "Downtime cost from compromised OT/IT systems"
            },
            saas: {
                name: "SaaS / Technology",
                riskMetric: "ARR at Risk",
                currency: "$",
                suffix: "M",
                description: "Annual recurring revenue at risk from customer churn"
            },
            insurance: {
                name: "Insurance",
                riskMetric: "Claims Fraud Risk",
                currency: "$",
                suffix: "M",
                description: "Fraudulent claims processing exposure"
            }
        };

        const threatIntelligence = {
            banking: [
                {
                    severity: "critical",
                    title: "APT29 Targeting Financial Payment Rails",
                    description: "Russian state-sponsored group actively exploiting over-privileged service accounts in SWIFT integration systems.",
                    impact: "+$1.2M",
                    multiplier: 1.5,
                    timestamp: "2 hours ago"
                },
                {
                    severity: "high",
                    title: "Banking API Keys Found in Dark Web Dump",
                    description: "Credential marketplace advertising access to Tier 2 bank APIs. Pattern matches your environment.",
                    impact: "+$800K",
                    multiplier: 1.3,
                    timestamp: "5 hours ago"
                },
                {
                    severity: "critical",
                    title: "Zero-Day in OAuth Library (CVE-2024-XXXX)",
                    description: "Authentication bypass affecting 47 of your service accounts. Active exploitation detected by CISA.",
                    impact: "+$1.5M",
                    multiplier: 1.8,
                    timestamp: "12 hours ago"
                }
            ]
        };

        const recommendations = {
            banking: [
                {
                    id: 1,
                    title: "Emergency: Rotate SWIFT Integration Credentials",
                    description: "Implement immediate rotation for SWIFT API credentials. APT29 actively targeting these exact access patterns. Deploy temporary MFA and alert monitoring during transition.",
                    priority: "critical",
                    targetVuln: "SWIFT Integration API",
                    riskReduction: 1.2,
                    effort: "4 hours",
                    difficulty: "Medium",
                    tiDriven: true,
                    automatable: true,
                    rollbackRisk: 8,
                    rollbackDetails: [
                        "CRITICAL system (international wire transfers)",
                        "Complex to revert (4 dependent systems)",
                        "15-minute window before transactions fail",
                        "Requires coordination with banking partners"
                    ]
                },
                {
                    id: 2,
                    title: "Deploy HashiCorp Vault for Treasury Systems",
                    description: "Migrate treasury management and wire transfer service accounts to centralized secret management. Eliminates hardcoded credentials and enables automated rotation.",
                    priority: "critical",
                    targetVuln: "Treasury Management Account",
                    riskReduction: 1.5,
                    effort: "3 days",
                    difficulty: "High",
                    tiDriven: true,
                    automatable: false,
                    rollbackRisk: 6
                },
                {
                    id: 3,
                    title: "Patch OAuth Library (CVE-2024-XXXX)",
                    description: "Zero-day patch available. Update OAuth library for core banking system. CISA reports active exploitation in financial sector.",
                    priority: "critical",
                    targetVuln: "Core Banking OAuth Client",
                    riskReduction: 0.6,
                    effort: "8 hours",
                    difficulty: "Low",
                    tiDriven: true,
                    automatable: true,
                    rollbackRisk: 4,
                    rollbackDetails: [
                        "Standard patching process",
                        "Can test in staging first",
                        "Quick rollback available",
                        "Minimal service disruption"
                    ]
                }
            ]
        };

        // Toast Notification Component
        function ToastNotification({ message, type = 'success', onClose }) {
            const [isHiding, setIsHiding] = React.useState(false);

            React.useEffect(() => {
                const timer = setTimeout(() => {
                    setIsHiding(true);
                    setTimeout(onClose, 300);
                }, 3000);

                return () => clearTimeout(timer);
            }, [onClose]);

            const handleClose = () => {
                setIsHiding(true);
                setTimeout(onClose, 300);
            };

            const getIcon = () => {
                switch(type) {
                    case 'success': return '✅';
                    case 'error': return '❌';
                    case 'warning': return '⚠️';
                    case 'block': return '🚫';
                    case 'investigate': return '🔍';
                    default: return '✅';
                }
            };

            const getTitle = () => {
                switch(type) {
                    case 'success': return 'Success';
                    case 'error': return 'Error';
                    case 'warning': return 'Warning';
                    case 'block': return 'Blocked';
                    case 'investigate': return 'Investigation Started';
                    default: return 'Notification';
                }
            };

            return (
                <div className={`toast-notification ${type} ${isHiding ? 'hiding' : ''}`}>
                    <button className="toast-close" onClick={handleClose}>×</button>
                    <div className="toast-header">
                        <span className="toast-icon">{getIcon()}</span>
                        <span className="toast-title">{getTitle()}</span>
                    </div>
                    <div className="toast-message">{message}</div>
                </div>
            );
        }

        // Persona Selector Component
        function PersonaSelector({ onSelectPersona }) {
            return (
                <div className="persona-selector-container">
                    <div className="persona-selector">
                        <h1>🛡️ Saviynt NHI Security Platform</h1>
                        <p className="persona-selector-subtitle">Choose your view</p>
                        
                        <div className="persona-cards">
                            <div className="persona-card" onClick={() => onSelectPersona('ciso')}>
                                <div className="persona-icon">👔</div>
                                <div className="persona-title">CISO</div>
                                <div className="persona-role">Executive View</div>
                                <ul className="persona-features">
                                    <li>Business risk in dollars</li>
                                    <li>Threat intelligence feed</li>
                                    <li>AI agent risk exposure</li>
                                    <li>Compliance dashboard</li>
                                    <li>Executive recommendations</li>
                                    <li>Board-ready metrics</li>
                                </ul>
                            </div>
                            
                            <div className="persona-card" onClick={() => onSelectPersona('itadmin')}>
                                <div className="persona-icon">🔧</div>
                                <div className="persona-title">IT Admin</div>
                                <div className="persona-role">Operations View</div>
                                <ul className="persona-features">
                                    <li>Action queues & tasks</li>
                                    <li>System health monitoring</li>
                                    <li>Rotation workflows</li>
                                    <li>Integration status</li>
                                    <li>MCP endpoint discovery</li>
                                    <li>AI agent inventory</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Anomaly data
        const anomalies = {
            banking: [
                { id: 1, severity: 'critical', time: '2 min ago', resource: 'Treasury Management API', accessor: 'api-key-swift-2019 (NHI)', anomaly: 'Access from Russia 🌍', impact: '$47M at risk' },
                { id: 2, severity: 'critical', time: '18 min ago', resource: 'Customer Payment DB', accessor: 'sales-bot (AI Agent)', anomaly: '10,000 records exported (100x normal)', impact: 'PCI violation risk' },
                { id: 3, severity: 'high', time: '1 hour ago', resource: 'Wire Transfer System', accessor: 'john.doe@company.com', anomaly: 'Access at 3:47 AM (off-hours)', impact: 'Unauthorized transfer risk' },
                { id: 4, severity: 'high', time: '2 hours ago', resource: 'SWIFT Integration', accessor: 'legacy-batch-job (NHI)', anomaly: 'Dormant account suddenly active', impact: 'Potential compromise' },
                { id: 5, severity: 'medium', time: '3 hours ago', resource: 'Core Banking API', accessor: 'mobile-app-prod (NHI)', anomaly: 'Rapid successive calls (2,847 in 1 min)', impact: 'API abuse detected' },
                { id: 6, severity: 'critical', time: '4 hours ago', resource: 'Customer Account DB', accessor: 'analytics-agent (AI Agent)', anomaly: 'Query patterns match data exfiltration', impact: 'Customer PII at risk' },
                { id: 7, severity: 'high', time: '5 hours ago', resource: 'Fraud Detection System', accessor: 'service-account-legacy', anomaly: 'Access from new device', impact: 'System integrity risk' },
                { id: 8, severity: 'medium', time: '6 hours ago', resource: 'Loan Processing API', accessor: 'external-partner-key (NHI)', anomaly: 'Accessing unauthorized resources', impact: 'Third-party risk' },
                { id: 9, severity: 'high', time: '7 hours ago', resource: 'Credit Card System', accessor: 'payment-bot (AI Agent)', anomaly: 'Multiple failed auth then success', impact: 'Credential stuffing attempt' },
                { id: 10, severity: 'medium', time: '8 hours ago', resource: 'Transaction History', accessor: 'reporting-service', anomaly: 'Unusual data volume (50GB)', impact: 'Storage cost spike' }
            ],
            healthcare: [
                { id: 1, severity: 'critical', time: '5 min ago', resource: 'EHR Patient Records', accessor: 'ehr-integration-bot (AI Agent)', anomaly: '5,000 patient records accessed', impact: 'HIPAA violation risk' },
                { id: 2, severity: 'critical', time: '22 min ago', resource: 'Pharmacy Database', accessor: 'api-key-2018 (NHI)', anomaly: 'Access from China 🌍', impact: 'Drug data theft risk' },
                { id: 3, severity: 'high', time: '45 min ago', resource: 'Billing System', accessor: 'finance-bot (AI Agent)', anomaly: 'Off-hours access (2:30 AM)', impact: 'Insurance fraud risk' }
            ],
            retail: [
                { id: 1, severity: 'critical', time: '1 min ago', resource: 'Payment Processor', accessor: 'checkout-api-prod (NHI)', anomaly: 'Access from suspicious IP', impact: 'Card data breach risk' },
                { id: 2, severity: 'critical', time: '15 min ago', resource: 'Customer Database', accessor: 'marketing-agent (AI Agent)', anomaly: 'Bulk export of 50K records', impact: 'GDPR violation risk' },
                { id: 3, severity: 'high', time: '1 hour ago', resource: 'Inventory System', accessor: 'warehouse-bot', anomaly: 'Unusual pricing queries', impact: 'Competitive intel leak' }
            ]
        };

        // Premium Feature Modal Component
        function PremiumFeatureModal({ feature, onClose, onProceed }) {
            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={(e) => e.stopPropagation()}>
                        <div className="modal-header">
                            <span style={{ fontSize: '32px' }}>{feature.icon}</span>
                            <h2 className="modal-title">{feature.title}</h2>
                            <button className="modal-close" onClick={onClose}>×</button>
                        </div>
                        
                        <div style={{ marginBottom: '20px' }}>
                            <p style={{ color: '#94a3b8', fontSize: '15px', lineHeight: '1.7', marginBottom: '20px' }}>
                                {feature.description}
                            </p>
                            
                            <div style={{ 
                                background: 'rgba(0, 188, 212, 0.1)',
                                border: '1px solid #00BCD4',
                                borderRadius: '8px',
                                padding: '16px',
                                marginBottom: '20px'
                            }}>
                                <div style={{ fontSize: '13px', fontWeight: '600', color: '#00BCD4', marginBottom: '12px' }}>
                                    What you'll get:
                                </div>
                                <ul style={{ margin: 0, paddingLeft: '20px' }}>
                                    {feature.benefits.map((benefit, idx) => (
                                        <li key={idx} style={{ color: '#e2e8f0', fontSize: '14px', marginBottom: '12px', lineHeight: '1.7' }}>
                                            {benefit}
                                        </li>
                                    ))}
                                </ul>
                            </div>
                            
                            {feature.impact && (
                                <div style={{ 
                                    background: 'rgba(0, 196, 140, 0.1)',
                                    border: '1px solid #00C48C',
                                    borderRadius: '8px',
                                    padding: '16px',
                                    marginBottom: '20px'
                                }}>
                                    <div style={{ fontSize: '13px', fontWeight: '600', color: '#00C48C', marginBottom: '12px' }}>
                                        Average Impact:
                                    </div>
                                    {feature.impact.map((item, idx) => (
                                        <div key={idx} style={{ color: '#e2e8f0', fontSize: '13px', marginBottom: '4px' }}>
                                            • {item}
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                        
                        <div style={{ display: 'flex', gap: '12px' }}>
                            <button 
                                className="action-button secondary" 
                                onClick={() => {
                                    // In real product: log telemetry, open email/calendar
                                    alert('In production: Opens calendar booking or sends email to Customer Success team');
                                    onClose();
                                }}
                                style={{ flex: 1 }}
                            >
                                📞 Contact Customer Success
                            </button>
                            <button 
                                className="action-button" 
                                onClick={onProceed}
                                style={{ flex: 1 }}
                            >
                                ✓ Proceed
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Saviynt AI Modal Component
        function SaviyntAIModal({ recommendation, onClose, onConfirm, industry }) {
            const [step, setStep] = useState('confirm');
            const [progress, setProgress] = useState(0);
            
            const steps = [
                { id: 1, text: "Pre-flight checks completed", status: step === 'executing' && progress >= 10 ? 'completed' : 'pending' },
                { id: 2, text: "Backup created successfully", status: step === 'executing' && progress >= 30 ? 'completed' : 'pending' },
                { id: 3, text: "Testing in staging environment", status: step === 'executing' && progress >= 50 ? 'in-progress' : 'pending' },
                { id: 4, text: "Generating new credentials", status: step === 'executing' && progress >= 70 ? 'in-progress' : 'pending' },
                { id: 5, text: "Rotating in production", status: step === 'executing' && progress >= 90 ? 'in-progress' : 'pending' },
                { id: 6, text: "Validating connectivity", status: step === 'executing' && progress >= 100 ? 'completed' : 'pending' }
            ];
            
            useEffect(() => {
                if (step === 'executing' && progress < 100) {
                    const timer = setTimeout(() => {
                        setProgress(prev => Math.min(prev + 10, 100));
                    }, 500);
                    return () => clearTimeout(timer);
                }
                if (progress >= 100) {
                    setTimeout(() => setStep('completed'), 1000);
                }
            }, [step, progress]);
            
            const handleConfirm = () => {
                // Just start the animation, don't apply fix yet
                setStep('executing');
                setProgress(0);
            };
            
            const handleComplete = () => {
                // Apply the fix after animation completes
                onConfirm();
                onClose();
            };
            
            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={(e) => e.stopPropagation()}>
                        <div className="modal-header">
                            <span className="saviynt-mascot">🤖</span>
                            <h2 className="modal-title">Saviynt AI Agent</h2>
                            <button className="modal-close" onClick={onClose}>×</button>
                        </div>
                        
                        {step === 'confirm' && (
                            <>
                                <div style={{ marginBottom: '20px' }}>
                                    <h3 style={{ color: '#fff', marginBottom: '12px' }}>{recommendation.title}</h3>
                                    <p style={{ color: '#94a3b8', fontSize: '14px', lineHeight: '1.6' }}>
                                        {recommendation.description}
                                    </p>
                                </div>
                                
                                <div className="rollback-risk">
                                    <div className="rollback-risk-header">
                                        ⚠️ Rollback Risk: {recommendation.rollbackRisk}/10
                                    </div>
                                    <ul className="rollback-risk-details">
                                        {recommendation.rollbackDetails?.map((detail, idx) => (
                                            <li key={idx}>• {detail}</li>
                                        ))}
                                    </ul>
                                </div>
                                
                                <div style={{ 
                                    background: 'rgba(0, 188, 212, 0.1)',
                                    border: '1px solid #00BCD4',
                                    borderRadius: '8px',
                                    padding: '16px',
                                    marginBottom: '20px'
                                }}>
                                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '16px' }}>
                                        <div>
                                            <div style={{ fontSize: '12px', color: '#94a3b8', marginBottom: '4px' }}>Risk Reduction</div>
                                            <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#00C48C' }}>
                                                -{industry.currency}{recommendation.riskReduction}{industry.suffix}
                                            </div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '12px', color: '#94a3b8', marginBottom: '4px' }}>Effort</div>
                                            <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#fff' }}>
                                                {recommendation.effort}
                                            </div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '12px', color: '#94a3b8', marginBottom: '4px' }}>Difficulty</div>
                                            <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#fff' }}>
                                                {recommendation.difficulty}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style={{ display: 'flex', gap: '12px' }}>
                                    <button className="action-button secondary" onClick={onClose}>
                                        Cancel
                                    </button>
                                    <button className="action-button" onClick={handleConfirm}>
                                        🤖 Confirm Auto-Fix
                                    </button>
                                </div>
                            </>
                        )}
                        
                        {step === 'executing' && (
                            <>
                                <div className="ai-agent-status">
                                    <div style={{ 
                                        display: 'flex', 
                                        justifyContent: 'space-between', 
                                        alignItems: 'center',
                                        marginBottom: '16px'
                                    }}>
                                        <div style={{ fontSize: '16px', fontWeight: '600', color: '#fff' }}>
                                            Status: In Progress
                                        </div>
                                        <div style={{ fontSize: '14px', color: '#00BCD4' }}>
                                            {progress}%
                                        </div>
                                    </div>
                                    
                                    <div className="progress-bar">
                                        <div className="progress-fill" style={{ width: `${progress}%` }}>
                                            {progress}%
                                        </div>
                                    </div>
                                    
                                    {steps.map(s => (
                                        <div key={s.id} className={`ai-step ${s.status}`}>
                                            <span className="ai-step-icon">
                                                {s.status === 'completed' ? '✅' : 
                                                 s.status === 'in-progress' ? '🔄' : '⏳'}
                                            </span>
                                            <span className="ai-step-text">{s.text}</span>
                                        </div>
                                    ))}
                                </div>
                                
                                <div style={{ display: 'flex', gap: '12px', marginTop: '20px' }}>
                                    <button className="action-button secondary" style={{ flex: 1 }}>
                                        View Logs
                                    </button>
                                    <button className="action-button danger" style={{ flex: 1 }}>
                                        Rollback
                                    </button>
                                </div>
                            </>
                        )}
                        
                        {step === 'completed' && (
                            <>
                                <div style={{ textAlign: 'center', padding: '40px 20px' }}>
                                    <div style={{ fontSize: '64px', marginBottom: '20px' }}>✅</div>
                                    <h3 style={{ color: '#00C48C', fontSize: '24px', marginBottom: '12px' }}>
                                        Fix Applied Successfully!
                                    </h3>
                                    <p style={{ color: '#94a3b8', fontSize: '14px' }}>
                                        {recommendation.title} has been completed.
                                        Risk reduced by {industry.currency}{recommendation.riskReduction}{industry.suffix}.
                                    </p>
                                </div>
                                
                                <button className="action-button" onClick={handleComplete}>
                                    Done
                                </button>
                            </>
                        )}
                    </div>
                </div>
            );
        }

        // CISO Dashboard Component
        function CISODashboard({ onSwitchPersona, cisoFeed, onAssignPriority, assignedTaskIds, completedTaskReductions }) {
            const [selectedIndustry] = useState('banking');
            const [riskThreshold, setRiskThreshold] = useState(5.0);
            const [baseRisk, setBaseRisk] = useState(3.2);
            const [aiAgentRiskThreshold, setAIAgentRiskThreshold] = useState(3.0);
            const [baseAIAgentRisk, setBaseAIAgentRisk] = useState(1.8);
            const [tiEnabled, setTiEnabled] = useState(true);
            const [appliedFixes, setAppliedFixes] = useState(new Set()); // Saviynt AI fixes
            const [simulatedFixes, setSimulatedFixes] = useState(new Set()); // Simulated fixes
            const [showAIModal, setShowAIModal] = useState(false);
            const [selectedRecommendation, setSelectedRecommendation] = useState(null);
            const [showPremiumModal, setShowPremiumModal] = useState(false);
            const [selectedPremiumFeature, setSelectedPremiumFeature] = useState(null);
            const [unlockedFeatures, setUnlockedFeatures] = useState(new Set());
            const [autoAccessControlEnabled, setAutoAccessControlEnabled] = useState(false);
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            const industry = industries[selectedIndustry];
            
            // Calculate Security Maturity Score
            const calculateMaturityScore = () => {
                let baseScore = 78; // Starting progress toward Level 4
                
                // Each applied fix adds progress (both AI and simulated)
                baseScore += (appliedFixes.size + simulatedFixes.size) * 3;
                
                // Completed IT tasks add progress
                baseScore += Math.min(completedTaskReductions * 5, 22);
                
                // Automatic access control enabled adds progress
                if (autoAccessControlEnabled) {
                    baseScore += 5;
                }
                
                // Cap at 100%
                return Math.min(baseScore, 100);
            };
            
            const maturityProgress = calculateMaturityScore();
            const maturityLevel = maturityProgress === 100 ? 4 : 3;
            const industryRank = Math.max(1, Math.floor(23 - (maturityProgress - 78) / 2));
            const industryPercentile = Math.ceil((1 - industryRank / 150) * 100);

            const currentRecommendations = recommendations[selectedIndustry] || [];
            const tiAlerts = threatIntelligence[selectedIndustry] || [];
            const currentAnomalies = anomalies[selectedIndustry] || anomalies.banking;
            
            // Sort recommendations by priority and TI
            const sortedRecommendations = [...currentRecommendations].sort((a, b) => {
                const priorityScore = { critical: 3, high: 2, medium: 1 };
                const aScore = priorityScore[a.priority] + (a.tiDriven ? 10 : 0);
                const bScore = priorityScore[b.priority] + (b.tiDriven ? 10 : 0);
                return bScore - aScore;
            });
            
            // Calculate risk reduction from AI fixes
            const aiFixRiskReduction = Array.from(appliedFixes).reduce((sum, fixId) => {
                const rec = sortedRecommendations.find(r => r.id === fixId);
                return sum + (rec ? rec.riskReduction : 0);
            }, 0);
            
            // Calculate risk reduction from simulated fixes
            const simulatedFixRiskReduction = Array.from(simulatedFixes).reduce((sum, fixId) => {
                const rec = sortedRecommendations.find(r => r.id === fixId);
                return sum + (rec ? rec.riskReduction : 0);
            }, 0);
            
            const totalRiskReduction = aiFixRiskReduction + simulatedFixRiskReduction;

            const tiMultiplier = tiEnabled && tiAlerts.length > 0
                ? tiAlerts.reduce((acc, alert) => acc + (alert.multiplier - 1), 1)
                : 1;

            // Add automatic access control reduction (blocks active threats)
            const autoAccessControlReduction = autoAccessControlEnabled ? 0.5 : 0;
            
            // Add completed task reductions to total risk reduction
            const totalReduction = totalRiskReduction + completedTaskReductions + autoAccessControlReduction;
            const currentRisk = Math.max(0, (baseRisk * tiMultiplier) - totalReduction);
            const riskPercentage = (currentRisk / riskThreshold) * 100;
            const needleRotation = Math.min((riskPercentage / 100) * 180 - 90, 90);
            
            // AI Agent risk calculations
            const aiAgentMultiplier = 1.4; // Simulate TI impact
            const currentAIAgentRisk = baseAIAgentRisk * aiAgentMultiplier;
            const aiAgentRiskPercentage = (currentAIAgentRisk / aiAgentRiskThreshold) * 100;
            const aiAgentNeedleRotation = Math.min((aiAgentRiskPercentage / 100) * 180 - 90, 90);

            const handleAIFix = (rec) => {
                setSelectedRecommendation(rec);
                setShowAIModal(true);
            };
            
            const handleConfirmAIFix = () => {
                if (selectedRecommendation) {
                    const newApplied = new Set(appliedFixes);
                    newApplied.add(selectedRecommendation.id);
                    setAppliedFixes(newApplied);
                    // Don't clear selectedRecommendation here - let the modal complete its flow
                }
            };
            
            const handlePremiumFeature = (featureKey) => {
                // Always show premium modal for aiAutoFix, skip for other features if already unlocked
                if (featureKey !== 'aiAutoFix' && unlockedFeatures.has(featureKey)) {
                    // Feature already unlocked, proceed directly
                    return true;
                }
                
                const premiumFeatures = {
                    aiAutoFix: {
                        icon: '🤖',
                        title: 'Saviynt AI Auto-Fix (Premium)',
                        description: 'Automatically remediate vulnerabilities, saving your team 40+ hours per month. This feature uses AI-powered automation to rotate credentials, patch systems, and enforce security policies without manual intervention.',
                        benefits: [
                            'Instant credential rotation with zero downtime',
                            'Zero-touch patching with automated testing',
                            'Rollback protection and safety checks',
                            'Compliance with rotation policies automatically',
                            'Real-time monitoring and alerting during fixes'
                        ],
                        impact: [
                            'Average $47K saved annually in labor costs',
                            '40+ hours saved per month per security engineer',
                            '85% faster remediation vs. manual processes',
                            '99.7% success rate with automated rollback'
                        ]
                    },
                    aiAgent: {
                        icon: '🤖',
                        title: 'AI Agent Risk Intelligence (Premium)',
                        description: 'We detected 23 AI agents in your environment - 12 are using personal credentials and pose $2.5M in risk exposure.',
                        benefits: [
                            'Real-time AI agent discovery and monitoring',
                            'Credential governance for LLM-powered tools',
                            'MCP endpoint tracking and management',
                            'Risk scoring for each agent',
                            'Auto-onboarding workflows for new agents'
                        ],
                        impact: [
                            '94% reduction in AI-related credential breaches',
                            'Average $180K saved annually in prevented incidents',
                            'Visibility into 100% of AI agents vs. 23% manual discovery'
                        ]
                    },
                    mcpDiscovery: {
                        icon: '🔌',
                        title: 'MCP Endpoint Discovery (Premium)',
                        description: '7 new MCP endpoints discovered in the last 24 hours - 4 are completely unmanaged and pose credential leakage risk. This is the #1 blind spot in modern security.',
                        benefits: [
                            'Automatic discovery of all MCP endpoints',
                            'Track which developers are spinning up MCPs',
                            'Monitor what data each endpoint accesses',
                            'Auto-onboarding workflows for governance',
                            'Secret sprawl prevention for AI infrastructure'
                        ],
                        impact: [
                            'Average 47 shadow MCP endpoints discovered per organization',
                            '73% of discovered MCPs had no security oversight',
                            '$95K average cost of single MCP-related breach'
                        ]
                    },
                    advancedTI: {
                        icon: '⚠️',
                        title: 'Advanced Threat Intelligence (Premium)',
                        description: 'APT29 is actively targeting organizations like yours. Your SWIFT integration API matches their attack pattern with 94% confidence.',
                        benefits: [
                            'Real-time threat actor tracking and profiling',
                            'Attack pattern correlation with your infrastructure',
                            'Early warning alerts (average 3 days before exploitation)',
                            'Automated remediation playbooks',
                            'Integration with 47 threat intelligence feeds'
                        ],
                        impact: [
                            '89% of threats detected before exploitation',
                            '$2.3M average breach cost prevented',
                            '72 hours average early warning vs. industry standard'
                        ]
                    },
                    attackPath: {
                        icon: '🎯',
                        title: 'Attack Path Analysis (Premium)',
                        description: 'Unlock comprehensive attack path analysis to see exactly how attackers could compromise your systems through NHIs.',
                        benefits: [
                            '5+ attack paths ranked by risk and likelihood',
                            'Step-by-step breach scenarios with visual graphs',
                            'Time-to-compromise estimates for each path',
                            'Remediation priority recommendations',
                            'Integration with your actual infrastructure topology'
                        ],
                        impact: [
                            '67% more effective remediation prioritization',
                            'Average 5.2 critical attack paths per organization',
                            '$430K saved by fixing highest-impact paths first'
                        ]
                    },
                    autoAccessControl: {
                        icon: '🚨',
                        title: 'Automatic Access Control (Premium)',
                        description: 'Stop manually investigating 47 anomalies. Let Saviynt AI automatically enforce access policies in real-time.',
                        benefits: [
                            'ML-based anomaly detection with 87% fewer false positives',
                            'Auto-block suspicious access attempts in <30 seconds',
                            'Adaptive policy enforcement based on behavior patterns',
                            'Real-time alerting for critical threats',
                            'Automated incident response workflows'
                        ],
                        impact: [
                            '94% reduction in manual security investigations',
                            '$230K saved annually in SOC labor costs',
                            '47 threats auto-blocked per month on average',
                            '99.4% uptime with intelligent blocking'
                        ]
                    }
                };
                
                setSelectedPremiumFeature(premiumFeatures[featureKey]);
                setShowPremiumModal(true);
                return false;
            };
            
            const handleProceedPremium = () => {
                if (selectedPremiumFeature) {
                    const featureKey = Object.keys({
                        aiAgent: selectedPremiumFeature.title.includes('AI Agent'),
                        mcpDiscovery: selectedPremiumFeature.title.includes('MCP'),
                        advancedTI: selectedPremiumFeature.title.includes('Threat Intelligence'),
                        attackPath: selectedPremiumFeature.title.includes('Attack Path'),
                        autoAccessControl: selectedPremiumFeature.title.includes('Access Control'),
                        aiAutoFix: selectedPremiumFeature.title.includes('Auto-Fix')
                    }).find(key => {
                        const match = {
                            aiAgent: selectedPremiumFeature.title.includes('AI Agent'),
                            mcpDiscovery: selectedPremiumFeature.title.includes('MCP'),
                            advancedTI: selectedPremiumFeature.title.includes('Threat Intelligence'),
                            attackPath: selectedPremiumFeature.title.includes('Attack Path'),
                            autoAccessControl: selectedPremiumFeature.title.includes('Access Control'),
                            aiAutoFix: selectedPremiumFeature.title.includes('Auto-Fix')
                        };
                        return match[key];
                    });
                    
                    if (featureKey) {
                        const newUnlocked = new Set(unlockedFeatures);
                        newUnlocked.add(featureKey);
                        setUnlockedFeatures(newUnlocked);
                        
                        if (featureKey === 'autoAccessControl') {
                            setAutoAccessControlEnabled(true);
                        }
                        
                        // If unlocking AI Auto-Fix, open the rollback modal
                        if (featureKey === 'aiAutoFix' && selectedRecommendation) {
                            setShowPremiumModal(false);
                            setSelectedPremiumFeature(null);
                            // Open the rollback/AI modal
                            setShowAIModal(true);
                        } else {
                            // For other features, just close the modal
                            setShowPremiumModal(false);
                            setSelectedPremiumFeature(null);
                            setSelectedRecommendation(null);
                        }
                    }
                }
            };

            return (
                <>
                    <div className="dashboard-container">
                        <div className="dashboard-nav">
                            <div className="dashboard-nav-left">
                                <div className="saviynt-logo">
                                    <span className="saviynt-mascot">🤖</span>
                                    Saviynt
                                </div>
                                <span className="persona-badge">👔 CISO View</span>
                            </div>
                            <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                                <button className="reset-simulation-btn" onClick={() => window.location.reload()}>
                                    🔄 Reset Simulation
                                </button>
                                <button className="switch-persona-btn" onClick={onSwitchPersona}>
                                    Switch to IT Admin View →
                                </button>
                            </div>
                        </div>

                        <div className="dashboard-header">
                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>
                                <h1>🛡️ NHI Security Posture Dashboard</h1>
                                <div className="nhi-ratio-badge">
                                    NHI to Human Ratio: 62:1
                                </div>
                            </div>
                            <p>Real-time threat intelligence and risk monitoring</p>
                            
                            {(appliedFixes.size > 0 || completedTaskReductions > 0) && (
                                <div style={{
                                    marginTop: '16px',
                                    padding: '16px',
                                    background: 'linear-gradient(135deg, #00C48C 0%, #00A067 100%)',
                                    borderRadius: '8px',
                                    color: 'white'
                                }}>
                                    <div style={{ fontSize: '14px', fontWeight: '600', marginBottom: '8px' }}>
                                        📊 Risk Reduction Active: {appliedFixes.size} simulated + {completedTaskReductions > 0 ? 'IT tasks completed' : '0 IT tasks'}
                                    </div>
                                    <div style={{ fontSize: '12px', opacity: 0.9 }}>
                                        Total risk reduced by {industry.currency}{totalReduction.toFixed(1)}{industry.suffix} ({((totalReduction / (baseRisk * tiMultiplier)) * 100).toFixed(0)}%). 
                                        {currentRisk < riskThreshold 
                                            ? ' ✓ Below threshold!' 
                                            : ` Still ${industry.currency}${(currentRisk - riskThreshold).toFixed(1)}${industry.suffix} above threshold.`}
                                    </div>
                                </div>
                            )}
                            
                            <div className="controls">
                                <div className="control-group">
                                    <label>Security Maturity Score</label>
                                    <div style={{ 
                                        padding: '10px',
                                        background: '#0f172a',
                                        border: '1px solid #334155',
                                        borderRadius: '6px',
                                        fontSize: '14px',
                                        color: '#e2e8f0',
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '8px',
                                        height: '42px'
                                    }}>
                                        <span style={{ fontSize: '16px' }}>🏆</span>
                                        <span style={{ fontWeight: '600', color: '#00BCD4' }}>
                                            {maturityProgress}/100
                                        </span>
                                        <span style={{ color: '#64748b' }}>
                                            (L{maturityLevel} • #{industryRank}/150)
                                        </span>
                                    </div>
                                </div>
                                <div className="control-group">
                                    <label>Risk Threshold ($M)</label>
                                    <input 
                                        type="number" 
                                        value={riskThreshold} 
                                        onChange={(e) => setRiskThreshold(parseFloat(e.target.value))}
                                        step="0.5"
                                        min="1"
                                        max="20"
                                    />
                                </div>
                                <div className="control-group">
                                    <label>Base Risk ($M)</label>
                                    <input 
                                        type="number" 
                                        value={baseRisk} 
                                        onChange={(e) => setBaseRisk(parseFloat(e.target.value))}
                                        step="0.1"
                                        min="0.5"
                                        max="10"
                                    />
                                </div>
                            </div>
                        </div>

                        <div className="grid">
                            <div className="card">
                                <div className="card-title">{industry.riskMetric}</div>
                                <div className="risk-dial-container">
                                    <div className="risk-dial">
                                        <div className="dial-background"></div>
                                        <div 
                                            className="dial-needle" 
                                            style={{ transform: `rotate(${needleRotation}deg)` }}
                                        ></div>
                                        <div className="dial-center">
                                            <div className="dial-value">
                                                {industry.currency}{currentRisk.toFixed(1)}{industry.suffix}
                                            </div>
                                            <div className="dial-label">Current Risk</div>
                                        </div>
                                    </div>
                                </div>
                                <div className="risk-summary">
                                    <div className="risk-row">
                                        <span className="risk-label">Base Risk:</span>
                                        <span className="risk-value">{industry.currency}{baseRisk.toFixed(1)}{industry.suffix}</span>
                                    </div>
                                    <div className="risk-row">
                                        <span className="risk-label">TI Adjustment:</span>
                                        <span className="risk-value" style={{ color: tiEnabled ? '#E63946' : '#64748b' }}>
                                            +{industry.currency}{(baseRisk * tiMultiplier - baseRisk).toFixed(1)}{industry.suffix}
                                        </span>
                                    </div>
                                    {simulatedFixRiskReduction > 0 && (
                                        <div className="risk-row">
                                            <span className="risk-label">Simulated fix:</span>
                                            <span className="risk-value" style={{ color: '#94a3b8' }}>
                                                -{industry.currency}{simulatedFixRiskReduction.toFixed(1)}{industry.suffix}
                                            </span>
                                        </div>
                                    )}
                                    {aiFixRiskReduction > 0 && (
                                        <div className="risk-row">
                                            <span className="risk-label">Saviynt AI:</span>
                                            <span className="risk-value" style={{ color: '#00C48C' }}>
                                                -{industry.currency}{aiFixRiskReduction.toFixed(1)}{industry.suffix}
                                            </span>
                                        </div>
                                    )}
                                    {autoAccessControlReduction > 0 && (
                                        <div className="risk-row">
                                            <span className="risk-label">Auto Access Control:</span>
                                            <span className="risk-value" style={{ color: '#00BCD4' }}>
                                                -{industry.currency}{autoAccessControlReduction.toFixed(1)}{industry.suffix}
                                            </span>
                                        </div>
                                    )}
                                    {completedTaskReductions > 0 && (
                                        <div className="risk-row">
                                            <span className="risk-label">IT Completed:</span>
                                            <span className="risk-value" style={{ color: '#00BCD4' }}>
                                                -{industry.currency}{completedTaskReductions.toFixed(1)}{industry.suffix}
                                            </span>
                                        </div>
                                    )}
                                    <div className="risk-row" style={{ paddingTop: '12px', borderTop: '2px solid #334155', marginTop: '8px' }}>
                                        <span className="risk-label">Threshold:</span>
                                        <span className="risk-value">{industry.currency}{riskThreshold.toFixed(1)}{industry.suffix}</span>
                                    </div>
                                    <button 
                                        className="toggle-button"
                                        onClick={() => setTiEnabled(!tiEnabled)}
                                    >
                                        {tiEnabled ? '🔴 Disable' : '🟢 Enable'} Threat Intelligence
                                    </button>
                                </div>
                            </div>
                            
                            <div className="card">
                                <div className="card-title">
                                    🤖 AI Agent Risk Exposure 
                                    {!unlockedFeatures.has('aiAgent') && <span style={{ marginLeft: '8px', fontSize: '11px', padding: '2px 8px', background: 'rgba(255, 107, 53, 0.2)', color: '#FF6B35', borderRadius: '4px', fontWeight: 'bold' }}>🔒 PREMIUM</span>}
                                </div>
                                <div 
                                    style={{ 
                                        cursor: !unlockedFeatures.has('aiAgent') ? 'pointer' : 'default',
                                        filter: !unlockedFeatures.has('aiAgent') ? 'blur(3px)' : 'none',
                                        pointerEvents: !unlockedFeatures.has('aiAgent') ? 'none' : 'auto'
                                    }}
                                >
                                    <div className="risk-dial-container">
                                        <div className="risk-dial">
                                            <div className="dial-background"></div>
                                            <div 
                                                className="dial-needle" 
                                                style={{ transform: `rotate(${aiAgentNeedleRotation}deg)` }}
                                            ></div>
                                            <div className="dial-center">
                                                <div className="dial-value">
                                                    {industry.currency}{currentAIAgentRisk.toFixed(1)}{industry.suffix}
                                                </div>
                                                <div className="dial-label">AI Agent Risk</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="risk-summary">
                                        <div className="risk-row">
                                            <span className="risk-label">Base AI Risk:</span>
                                            <span className="risk-value">{industry.currency}{baseAIAgentRisk.toFixed(1)}{industry.suffix}</span>
                                        </div>
                                        <div className="risk-row">
                                            <span className="risk-label">Active Agents:</span>
                                            <span className="risk-value">23</span>
                                        </div>
                                        <div className="risk-row">
                                            <span className="risk-label">Unmanaged:</span>
                                            <span className="risk-value" style={{ color: '#E63946' }}>12</span>
                                        </div>
                                        <div className="risk-row" style={{ paddingTop: '12px', borderTop: '2px solid #334155', marginTop: '8px' }}>
                                            <span className="risk-label">Threshold:</span>
                                            <span className="risk-value">{industry.currency}{aiAgentRiskThreshold.toFixed(1)}{industry.suffix}</span>
                                        </div>
                                    </div>
                                </div>
                                {!unlockedFeatures.has('aiAgent') && (
                                    <button 
                                        className="toggle-button"
                                        onClick={() => handlePremiumFeature('aiAgent')}
                                    >
                                        🔒 Unlock AI Agent Monitoring
                                    </button>
                                )}
                            </div>

                            <div className="card">
                                <div className="card-title">📡 Live Threat Intelligence Feed</div>
                                <div className="ti-feed">
                                    {tiEnabled ? (
                                        tiAlerts.map((alert, index) => (
                                            <div key={index} className={`ti-alert ${alert.severity}`}>
                                                <div className="ti-alert-header">
                                                    <div className="ti-alert-title">{alert.title}</div>
                                                    <div className="ti-alert-severity">{alert.severity}</div>
                                                </div>
                                                <div className="ti-alert-body">{alert.description}</div>
                                                <div className="ti-alert-impact">
                                                    Risk Impact: {alert.impact} ({(alert.multiplier * 100 - 100).toFixed(0)}% increase)
                                                </div>
                                                <div style={{ fontSize: '11px', color: '#64748b', marginTop: '8px' }}>
                                                    {alert.timestamp}
                                                </div>
                                            </div>
                                        ))
                                    ) : (
                                        <div style={{ padding: '20px', textAlign: 'center', color: '#64748b' }}>
                                            Threat Intelligence monitoring disabled
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                            
                        <div className="card">
                            <div className="card-title">
                                🎯 Attack Path Analysis 
                                {!unlockedFeatures.has('attackPath') && <span style={{ marginLeft: '8px', fontSize: '11px', padding: '2px 8px', background: 'rgba(255, 107, 53, 0.2)', color: '#FF6B35', borderRadius: '4px', fontWeight: 'bold' }}>🔒 PREMIUM</span>}
                            </div>
                            <div style={{ marginBottom: '16px' }}>
                                <div style={{ fontSize: '14px', color: '#94a3b8', marginBottom: '12px' }}>
                                    We identified <strong style={{ color: '#E63946' }}>5 critical attack paths</strong> through your NHI infrastructure.
                                </div>
                            </div>
                            
                            <div style={{ 
                                padding: '16px',
                                background: 'rgba(230, 57, 70, 0.1)',
                                border: '1px solid #E63946',
                                borderRadius: '8px',
                                marginBottom: '16px'
                            }}>
                                <div style={{ fontSize: '12px', color: '#94a3b8', marginBottom: '8px' }}>
                                    TOP RISK - PREVIEW:
                                </div>
                                <div style={{ fontSize: '14px', fontWeight: '600', color: '#fff', marginBottom: '8px' }}>
                                    Path: Stale API → SWIFT → Treasury
                                </div>
                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '12px', marginTop: '12px' }}>
                                    <div>
                                        <div style={{ fontSize: '11px', color: '#94a3b8' }}>Risk</div>
                                        <div style={{ fontSize: '16px', fontWeight: 'bold', color: '#E63946' }}>CRITICAL</div>
                                    </div>
                                    <div>
                                        <div style={{ fontSize: '11px', color: '#94a3b8' }}>Likelihood</div>
                                        <div style={{ fontSize: '16px', fontWeight: 'bold', color: '#fff' }}>87%</div>
                                    </div>
                                    <div>
                                        <div style={{ fontSize: '11px', color: '#94a3b8' }}>Impact</div>
                                        <div style={{ fontSize: '16px', fontWeight: 'bold', color: '#fff' }}>{industry.currency}47M</div>
                                    </div>
                                </div>
                            </div>
                            
                            {!unlockedFeatures.has('attackPath') ? (
                                <>
                                    <div style={{ 
                                        padding: '40px 20px',
                                        background: 'rgba(0, 0, 0, 0.3)',
                                        borderRadius: '8px',
                                        textAlign: 'center',
                                        filter: 'blur(5px)',
                                        marginBottom: '16px'
                                    }}>
                                        <div style={{ fontSize: '14px', color: '#64748b' }}>
                                            4 more attack paths available
                                        </div>
                                    </div>
                                    <button 
                                        className="action-button"
                                        onClick={() => handlePremiumFeature('attackPath')}
                                    >
                                        🔒 Unlock All Attack Paths
                                    </button>
                                </>
                            ) : (
                                <div style={{ display: 'grid', gap: '8px' }}>
                                    {[
                                        { path: 'OAuth Bypass → Customer DB', risk: 'CRITICAL', likelihood: '73%', steps: 3 },
                                        { path: 'Payment Gateway → Card Data', risk: 'HIGH', likelihood: '61%', steps: 5 },
                                        { path: 'EHR Integration → Patient Records', risk: 'HIGH', likelihood: '54%', steps: 4 },
                                        { path: 'Analytics API → Usage Metrics', risk: 'MEDIUM', likelihood: '31%', steps: 2 }
                                    ].map((item, idx) => (
                                        <div key={idx} style={{
                                            padding: '12px',
                                            background: 'rgba(0, 0, 0, 0.3)',
                                            border: '1px solid #334155',
                                            borderRadius: '6px',
                                            display: 'flex',
                                            justifyContent: 'space-between',
                                            alignItems: 'center'
                                        }}>
                                            <div>
                                                <div style={{ fontSize: '13px', fontWeight: '600', color: '#fff' }}>
                                                    {idx + 2}. {item.path}
                                                </div>
                                                <div style={{ fontSize: '11px', color: '#94a3b8', marginTop: '4px' }}>
                                                    Likelihood: {item.likelihood} | Steps: {item.steps}
                                                </div>
                                            </div>
                                            <span className={`status-badge ${item.risk.toLowerCase()}`}>
                                                {item.risk}
                                            </span>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        <div className="grid">
                            <div className="card">
                                <div className="card-title">
                                    🚨 Anomalous Access Detected 
                                    <span style={{ marginLeft: '8px', fontSize: '14px', color: '#E63946', fontWeight: 'bold' }}>LIVE 🔴</span>
                                </div>
                                <div style={{ marginBottom: '16px' }}>
                                    <div style={{ fontSize: '14px', color: '#94a3b8', marginBottom: '8px' }}>
                                        <strong style={{ color: '#E63946', fontSize: '20px' }}>47</strong> suspicious access attempts detected in the last 24 hours
                                    </div>
                                </div>
                                
                                <div style={{ 
                                    maxHeight: '400px', 
                                    overflowY: 'auto',
                                    marginBottom: '16px'
                                }}>
                                    {currentAnomalies.slice(0, 10).map((anomaly) => (
                                        <div key={anomaly.id} style={{
                                            padding: '16px',
                                            background: anomaly.severity === 'critical' ? 'rgba(230, 57, 70, 0.1)' :
                                                       anomaly.severity === 'high' ? 'rgba(255, 107, 53, 0.1)' :
                                                       'rgba(0, 188, 212, 0.1)',
                                            border: `1px solid ${anomaly.severity === 'critical' ? '#E63946' :
                                                                   anomaly.severity === 'high' ? '#FF6B35' : '#00BCD4'}`,
                                            borderRadius: '8px',
                                            marginBottom: '12px'
                                        }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '10px' }}>
                                                <span className={`status-badge ${anomaly.severity}`}>
                                                    {anomaly.severity.toUpperCase()}
                                                </span>
                                                <span style={{ fontSize: '11px', color: '#64748b' }}>{anomaly.time}</span>
                                            </div>
                                            <div style={{ fontSize: '13px', fontWeight: '600', color: '#fff', marginBottom: '6px' }}>
                                                Resource: {anomaly.resource}
                                            </div>
                                            <div style={{ fontSize: '12px', color: '#94a3b8', marginBottom: '6px', lineHeight: '1.6' }}>
                                                Accessor: {anomaly.accessor}
                                            </div>
                                            <div style={{ fontSize: '12px', color: '#e2e8f0', marginBottom: '10px', lineHeight: '1.6' }}>
                                                Anomaly: {anomaly.anomaly}
                                            </div>
                                            <div style={{ fontSize: '12px', fontWeight: '600', color: '#E63946' }}>
                                                Impact: {anomaly.impact}
                                            </div>
                                            {autoAccessControlEnabled && (
                                                <div style={{
                                                    marginTop: '12px',
                                                    padding: '8px',
                                                    background: 'rgba(0, 196, 140, 0.2)',
                                                    border: '1px solid #00C48C',
                                                    borderRadius: '4px',
                                                    fontSize: '11px',
                                                    color: '#00C48C',
                                                    fontWeight: '600'
                                                }}>
                                                    ✓ Auto-blocked by Saviynt AI
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                    {currentAnomalies.length > 10 && (
                                        <div style={{ textAlign: 'center', padding: '12px', color: '#64748b', fontSize: '13px' }}>
                                            ... {currentAnomalies.length - 10} more anomalies
                                        </div>
                                    )}
                                </div>
                                
                                <button 
                                    className="action-button"
                                    onClick={() => handlePremiumFeature('autoAccessControl')}
                                    disabled={autoAccessControlEnabled}
                                    style={{
                                        opacity: autoAccessControlEnabled ? 0.7 : 1,
                                        background: autoAccessControlEnabled ? 'linear-gradient(135deg, #00C48C 0%, #00A067 100%)' : undefined
                                    }}
                                >
                                    {autoAccessControlEnabled ? '✓ Automatic Access Control Active' : '🤖 Enforce Automatic Access Control'}
                                </button>
                            </div>
                            <div className="card">
                                <div className="card-title">📋 IT Admin Activity Feed</div>
                                <div style={{ maxHeight: '300px', overflowY: 'auto' }}>
                                    {cisoFeed.length > 0 ? (
                                        cisoFeed.map((item, idx) => (
                                            <div key={idx} className="ciso-feed-item">
                                                <div><strong>{item.action}</strong> {item.description}</div>
                                                <div className="timestamp">{item.timestamp}</div>
                                            </div>
                                        ))
                                    ) : (
                                        <div style={{ padding: '40px 20px', textAlign: 'center', color: '#64748b' }}>
                                            No recent activity
                                        </div>
                                    )}
                                </div>
                            </div>
                            
                            <div className="card">
                                <div className="card-title">📊 Key Security Metrics</div>
                                <div className="metrics-grid">
                                    <div className="metric">
                                        <div className="metric-label">Mean Time to Detect</div>
                                        <div className="metric-value">4.2h</div>
                                        <div className="metric-trend down">↓ 12% this month</div>
                                    </div>
                                    <div className="metric">
                                        <div className="metric-label">Mean Time to Remediate</div>
                                        <div className="metric-value">18h</div>
                                        <div className="metric-trend up">↑ 8% this month</div>
                                    </div>
                                    <div className="metric">
                                        <div className="metric-label">Secrets Rotation</div>
                                        <div className="metric-value">67%</div>
                                        <div className="metric-trend down">↓ 5% this month</div>
                                    </div>
                                    <div className="metric">
                                        <div className="metric-label">Least-Privilege</div>
                                        <div className="metric-value">72%</div>
                                        <div className="metric-trend down">↑ 15% this month</div>
                                    </div>
                                    <div className="metric">
                                        <div className="metric-label">Orphaned Accounts</div>
                                        <div className="metric-value">142</div>
                                        <div className="metric-trend up">↑ 23 this month</div>
                                    </div>
                                    <div className="metric">
                                        <div className="metric-label">Credential Exposure</div>
                                        <div className="metric-value">38</div>
                                        <div className="metric-trend down">↓ 6 this month</div>
                                    </div>
                                    <div className="metric">
                                        <div className="metric-label">Policy Violations</div>
                                        <div className="metric-value">91</div>
                                        <div className="metric-trend up">↑ 14% this month</div>
                                    </div>
                                    <div className="metric">
                                        <div className="metric-label">Compliance Score</div>
                                        <div className="metric-value">84%</div>
                                        <div className="metric-trend down">↑ 3% this month</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="card">
                            <div className="card-title">🎯 Risk Reduction Recommendations</div>
                            
                            <div className="impact-summary">
                                <div className="impact-summary-title">Potential Impact</div>
                                <div className="impact-stats">
                                    <div className="impact-stat">
                                        <div className="impact-stat-value">
                                            {industry.currency}{totalRiskReduction.toFixed(1)}{industry.suffix}
                                        </div>
                                        <div className="impact-stat-label">Risk Reduced</div>
                                    </div>
                                    <div className="impact-stat">
                                        <div className="impact-stat-value">
                                            {appliedFixes.size + simulatedFixes.size}
                                        </div>
                                        <div className="impact-stat-label">Fixes Applied</div>
                                    </div>
                                    <div className="impact-stat">
                                        <div className="impact-stat-value">
                                            {sortedRecommendations.filter(r => r.automatable).length}
                                        </div>
                                        <div className="impact-stat-label">AI Automatable</div>
                                    </div>
                                </div>
                            </div>

                            <div className="recommendations-container">
                                {sortedRecommendations.map((rec) => (
                                    <div 
                                        key={rec.id} 
                                        className={`recommendation ${(appliedFixes.has(rec.id) || simulatedFixes.has(rec.id)) ? 'applied' : ''}`}
                                    >
                                        <div className="recommendation-header">
                                            <div className="recommendation-title">
                                                {(appliedFixes.has(rec.id) || simulatedFixes.has(rec.id)) ? '✅ ' : ''}{rec.title}
                                                {rec.tiDriven && !appliedFixes.has(rec.id) && !simulatedFixes.has(rec.id) && ' ⚠️'}
                                            </div>
                                            <div className={`recommendation-priority ${rec.priority}`}>
                                                {rec.priority}
                                            </div>
                                        </div>
                                        
                                        <div className="recommendation-body">
                                            {rec.description}
                                        </div>
                                        
                                        <div className="recommendation-metrics">
                                            <div className="recommendation-metric">
                                                <div className="recommendation-metric-label">Risk Reduction</div>
                                                <div className="recommendation-metric-value positive">
                                                    -{industry.currency}{rec.riskReduction.toFixed(1)}{industry.suffix}
                                                </div>
                                            </div>
                                            <div className="recommendation-metric">
                                                <div className="recommendation-metric-label">Effort</div>
                                                <div className="recommendation-metric-value">
                                                    {rec.effort}
                                                </div>
                                            </div>
                                            <div className="recommendation-metric">
                                                <div className="recommendation-metric-label">Difficulty</div>
                                                <div className="recommendation-metric-value">
                                                    {rec.difficulty}
                                                </div>
                                            </div>
                                        </div>
                                        
                                        {!appliedFixes.has(rec.id) && !simulatedFixes.has(rec.id) && !assignedTaskIds.has(rec.id) ? (
                                            <div className="recommendation-actions">
                                                <button 
                                                    className="apply-button secondary"
                                                    onClick={() => {
                                                        const newSimulated = new Set(simulatedFixes);
                                                        newSimulated.add(rec.id);
                                                        setSimulatedFixes(newSimulated);
                                                    }}
                                                >
                                                    Simulate Fix
                                                </button>
                                                {rec.automatable && (
                                                    <button 
                                                        className="apply-button ai"
                                                        onClick={() => {
                                                            setSelectedRecommendation(rec);
                                                            handlePremiumFeature('aiAutoFix');
                                                        }}
                                                    >
                                                        🤖 Fix via Saviynt AI
                                                    </button>
                                                )}
                                                <button 
                                                    className="apply-button secondary"
                                                    onClick={() => onAssignPriority(rec)}
                                                >
                                                    Assign to IT
                                                </button>
                                            </div>
                                        ) : (appliedFixes.has(rec.id) || simulatedFixes.has(rec.id) || assignedTaskIds.has(rec.id)) ? (
                                            <div className="recommendation-actions">
                                                {rec.automatable && appliedFixes.has(rec.id) && (
                                                    <button 
                                                        className="apply-button ai"
                                                        disabled
                                                        style={{
                                                            opacity: 0.6,
                                                            cursor: 'not-allowed',
                                                            background: 'linear-gradient(135deg, #00C48C 0%, #00A067 100%)',
                                                            color: '#fff'
                                                        }}
                                                    >
                                                        ✓ Fixed by Saviynt AI
                                                    </button>
                                                )}
                                                {simulatedFixes.has(rec.id) && (
                                                    <button 
                                                        className="apply-button secondary"
                                                        disabled
                                                        style={{
                                                            opacity: 0.6,
                                                            cursor: 'not-allowed',
                                                            background: 'linear-gradient(135deg, #64748b 0%, #475569 100%)'
                                                        }}
                                                    >
                                                        ✓ Simulated Fix Applied
                                                    </button>
                                                )}
                                                {assignedTaskIds.has(rec.id) && !appliedFixes.has(rec.id) && !simulatedFixes.has(rec.id) && (
                                                    <button 
                                                        className="apply-button secondary"
                                                        disabled
                                                        style={{
                                                            opacity: 0.5,
                                                            cursor: 'not-allowed',
                                                            background: 'linear-gradient(135deg, #64748b 0%, #475569 100%)'
                                                        }}
                                                    >
                                                        ✓ Assigned to IT
                                                    </button>
                                                )}
                                            </div>
                                        ) : null}
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                    
                    {showAIModal && selectedRecommendation && (
                        <SaviyntAIModal 
                            recommendation={selectedRecommendation}
                            industry={industry}
                            onClose={() => {
                                setShowAIModal(false);
                                setSelectedRecommendation(null);
                            }}
                            onConfirm={handleConfirmAIFix}
                        />
                    )}
                    
                    {showPremiumModal && selectedPremiumFeature && (
                        <PremiumFeatureModal 
                            feature={selectedPremiumFeature}
                            onClose={() => {
                                setShowPremiumModal(false);
                                setSelectedPremiumFeature(null);
                                setSelectedRecommendation(null);
                            }}
                            onProceed={handleProceedPremium}
                        />
                    )}
                </>
            );
        }

        // IT Admin Dashboard Component
        function ITAdminDashboard({ onSwitchPersona, onTaskComplete, assignedTasks }) {
            const [healthScore, setHealthScore] = useState(78);
            const [rotationProgress, setRotationProgress] = useState(52);
            const [completedTasks, setCompletedTasks] = useState([]);
            const [showPremiumModal, setShowPremiumModal] = useState(false);
            const [selectedPremiumFeature, setSelectedPremiumFeature] = useState(null);
            const [unlockedFeatures, setUnlockedFeatures] = useState(new Set());
            const [toasts, setToasts] = useState([]);
            const [actedAnomalies, setActedAnomalies] = useState({});
            const currentAnomalies = anomalies.banking;
            
            const getHealthColor = (score) => {
                if (score >= 90) return 'excellent';
                if (score >= 75) return 'good';
                if (score >= 60) return 'fair';
                return 'poor';
            };
            
            const showToast = (message, type = 'success') => {
                const id = Date.now();
                setToasts(prev => [...prev, { id, message, type }]);
            };
            
            const removeToast = (id) => {
                setToasts(prev => prev.filter(toast => toast.id !== id));
            };
            
            const handleCompleteTask = (taskName, riskReduction, anomalyId, actionType) => {
                const timestamp = new Date().toLocaleTimeString();
                const task = {
                    action: 'Task Completed:',
                    description: taskName,
                    timestamp: timestamp,
                    riskReduction: riskReduction
                };
                setCompletedTasks([task, ...completedTasks]);
                onTaskComplete(task);
                setHealthScore(prev => Math.min(100, prev + 5));
                
                // Mark anomaly as acted upon
                if (anomalyId) {
                    setActedAnomalies(prev => ({
                        ...prev,
                        [anomalyId]: actionType
                    }));
                }
                
                // Show toast notification
                if (actionType === 'investigate') {
                    showToast(`Investigation started for: ${taskName.replace('Investigated ', '')}`, 'investigate');
                } else if (actionType === 'block') {
                    showToast(`Successfully blocked: ${taskName.replace('Blocked ', '')}`, 'block');
                } else {
                    showToast(taskName, 'success');
                }
            };
            
            const handlePremiumFeature = (featureKey) => {
                if (unlockedFeatures.has(featureKey)) {
                    return true;
                }
                
                const premiumFeatures = {
                    mcpDiscovery: {
                        icon: '🔌',
                        title: 'MCP Endpoint Discovery (Premium)',
                        description: '7 new MCP endpoints discovered in the last 24 hours - 4 are completely unmanaged. Get full visibility and control over your MCP infrastructure.',
                        benefits: [
                            'Automatic discovery of all MCP endpoints',
                            'Developer activity tracking',
                            'Data access monitoring per endpoint',
                            'Auto-onboarding workflows',
                            'Secret sprawl prevention'
                        ],
                        impact: [
                            'Average 47 shadow endpoints discovered',
                            '73% had no security oversight',
                            '$95K average breach prevention'
                        ]
                    },
                    aiAgentMonitoring: {
                        icon: '🤖',
                        title: 'AI Agent Monitoring (Premium)',
                        description: '12 new AI agents detected in the last 24 hours. 8 have no NHI governance. Monitor and manage all AI agents from one dashboard.',
                        benefits: [
                            'Real-time agent discovery',
                            'Credential governance automation',
                            'Risk scoring per agent',
                            'Auto-onboarding for new agents',
                            'Policy enforcement'
                        ],
                        impact: [
                            '94% reduction in AI-related breaches',
                            '$180K saved in prevented incidents',
                            '100% agent visibility achieved'
                        ]
                    }
                };
                
                setSelectedPremiumFeature(premiumFeatures[featureKey]);
                setShowPremiumModal(true);
                return false;
            };
            
            const handleProceedPremium = () => {
                if (selectedPremiumFeature) {
                    const featureKey = selectedPremiumFeature.title.includes('MCP') ? 'mcpDiscovery' : 'aiAgentMonitoring';
                    const newUnlocked = new Set(unlockedFeatures);
                    newUnlocked.add(featureKey);
                    setUnlockedFeatures(newUnlocked);
                    
                    // Close the modal
                    setShowPremiumModal(false);
                    setSelectedPremiumFeature(null);
                }
            };
            
            return (
                <>
                <div className="dashboard-container">
                    <div className="dashboard-nav">
                        <div className="dashboard-nav-left">
                            <div className="saviynt-logo">
                                <span className="saviynt-mascot">🤖</span>
                                Saviynt
                            </div>
                            <span className="persona-badge">🔧 IT Admin View</span>
                        </div>
                        <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                            <button className="reset-simulation-btn" onClick={() => window.location.reload()}>
                                🔄 Reset Simulation
                            </button>
                            <button className="switch-persona-btn" onClick={onSwitchPersona}>
                                ← Switch to CISO View
                            </button>
                        </div>
                    </div>

                    <div className="dashboard-header">
                        <h1>🔧 NHI Operations Dashboard</h1>
                        <p>Task management and system health monitoring</p>
                    </div>

                    <div className="grid">
                        <div className="card">
                            <div className="card-title">📊 Overall Health Score</div>
                            <div className={`health-score ${getHealthColor(healthScore)}`}>
                                {healthScore}/100
                            </div>
                            <div style={{ textAlign: 'center', color: '#94a3b8', fontSize: '14px' }}>
                                {healthScore >= 90 ? 'Excellent' :
                                 healthScore >= 75 ? 'Good' :
                                 healthScore >= 60 ? 'Fair' : 'Needs Attention'}
                            </div>
                            <div className="metrics-grid" style={{ marginTop: '20px' }}>
                                <div className="metric">
                                    <div className="metric-label">Systems Connected</div>
                                    <div className="metric-value">23/25</div>
                                </div>
                                <div className="metric">
                                    <div className="metric-label">Automation Rate</div>
                                    <div className="metric-value">67%</div>
                                </div>
                            </div>
                        </div>

                        <div className="card">
                            <div className="card-title">🚨 Action Queue</div>
                            <div className="action-queue">
                                <div className="queue-section urgent">
                                    <div className="queue-header">
                                        <span className="queue-title">🔴 URGENT</span>
                                        <span className="queue-count">5</span>
                                    </div>
                                    <div className="queue-items">
                                        • 5 certificates expire in 7 days<br/>
                                        • 3 failed rotations need retry
                                    </div>
                                </div>
                                
                                <div className="queue-section due-soon">
                                    <div className="queue-header">
                                        <span className="queue-title">🟡 DUE SOON</span>
                                        <span className="queue-count">23</span>
                                    </div>
                                    <div className="queue-items">
                                        • 23 access reviews overdue<br/>
                                        • 12 NHIs need attestation
                                    </div>
                                </div>
                                
                                <div className="queue-section scheduled">
                                    <div className="queue-header">
                                        <span className="queue-title">🟢 SCHEDULED</span>
                                        <span className="queue-count">47</span>
                                    </div>
                                    <div className="queue-items">
                                        • 47 certs in 90-day window<br/>
                                        • 15 planned rotations this week
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="card">
                            <div className="card-title">
                                🔌 MCP Endpoint Discovery
                                {!unlockedFeatures.has('mcpDiscovery') && <span style={{ marginLeft: '8px', fontSize: '11px', padding: '2px 8px', background: 'rgba(255, 107, 53, 0.2)', color: '#FF6B35', borderRadius: '4px', fontWeight: 'bold' }}>🔒 PREMIUM</span>}
                            </div>
                            <div style={{ marginBottom: '16px' }}>
                                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                                    <span style={{ color: '#94a3b8', fontSize: '14px' }}>Last 24 Hours</span>
                                    <span style={{ color: '#fff', fontSize: '20px', fontWeight: 'bold' }}>7 new</span>
                                </div>
                                <div style={{ fontSize: '12px', color: '#E63946' }}>
                                    ⚠️ Trend: ↑ 40% (elevated activity)
                                </div>
                            </div>
                            
                            <div style={{ 
                                display: 'grid', 
                                gap: '8px',
                                filter: !unlockedFeatures.has('mcpDiscovery') ? 'blur(3px)' : 'none',
                                pointerEvents: !unlockedFeatures.has('mcpDiscovery') ? 'none' : 'auto'
                            }}>
                                <div style={{ padding: '10px', background: 'rgba(230, 57, 70, 0.1)', border: '1px solid #E63946', borderRadius: '6px' }}>
                                    <div style={{ fontSize: '13px', fontWeight: '600', color: '#E63946', marginBottom: '4px' }}>
                                        🔴 Unmanaged: 4
                                    </div>
                                    <div style={{ fontSize: '11px', color: '#94a3b8' }}>
                                        mcp://claude-desktop/filesystem<br/>
                                        mcp://slack-agent/messages<br/>
                                        mcp://github-copilot/repo-access<br/>
                                        mcp://cursor-ide/codebase
                                    </div>
                                </div>
                                
                                <div style={{ padding: '10px', background: 'rgba(255, 107, 53, 0.1)', border: '1px solid #FF6B35', borderRadius: '6px' }}>
                                    <div style={{ fontSize: '13px', fontWeight: '600', color: '#FF6B35', marginBottom: '4px' }}>
                                        🟡 Under Review: 2
                                    </div>
                                    <div style={{ fontSize: '11px', color: '#94a3b8' }}>
                                        mcp://salesforce-agent/crm<br/>
                                        mcp://jira-assistant/projects
                                    </div>
                                </div>
                                
                                <div style={{ padding: '10px', background: 'rgba(0, 196, 140, 0.1)', border: '1px solid #00C48C', borderRadius: '6px' }}>
                                    <div style={{ fontSize: '13px', fontWeight: '600', color: '#00C48C' }}>
                                        🟢 Managed: 1
                                    </div>
                                </div>
                            </div>
                            
                            <button 
                                className="action-button" 
                                style={{ marginTop: '12px' }}
                                onClick={() => unlockedFeatures.has('mcpDiscovery') ? null : handlePremiumFeature('mcpDiscovery')}
                            >
                                {unlockedFeatures.has('mcpDiscovery') ? 'Review All Endpoints' : '🔒 Unlock MCP Discovery'}
                            </button>
                        </div>

                        <div className="card">
                            <div className="card-title">
                                🤖 AI Agent Activity
                                {!unlockedFeatures.has('aiAgentMonitoring') && <span style={{ marginLeft: '8px', fontSize: '11px', padding: '2px 8px', background: 'rgba(255, 107, 53, 0.2)', color: '#FF6B35', borderRadius: '4px', fontWeight: 'bold' }}>🔒 PREMIUM</span>}
                            </div>
                            <div style={{ marginBottom: '16px' }}>
                                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                                    <span style={{ color: '#94a3b8', fontSize: '14px' }}>Last 24 Hours</span>
                                    <span style={{ color: '#fff', fontSize: '20px', fontWeight: 'bold' }}>12 new</span>
                                </div>
                                <div style={{ fontSize: '12px', color: '#E63946' }}>
                                    ⚠️ Trend: ↑ 25% (elevated activity)
                                </div>
                            </div>
                            
                            <div style={{ 
                                marginBottom: '16px',
                                filter: !unlockedFeatures.has('aiAgentMonitoring') ? 'blur(3px)' : 'none',
                                pointerEvents: !unlockedFeatures.has('aiAgentMonitoring') ? 'none' : 'auto'
                            }}>
                                <div style={{ fontSize: '12px', color: '#94a3b8', marginBottom: '8px' }}>By Type:</div>
                                <div style={{ fontSize: '13px', color: '#e2e8f0', lineHeight: '1.8' }}>
                                    • Code Assistants: 5<br/>
                                    • Chat Agents: 3<br/>
                                    • Workflow Automation: 2<br/>
                                    • Custom Agents: 2
                                </div>
                            </div>
                            
                            <div style={{ 
                                padding: '12px', 
                                background: 'rgba(230, 57, 70, 0.1)', 
                                border: '1px solid #E63946', 
                                borderRadius: '6px', 
                                marginBottom: '12px',
                                filter: !unlockedFeatures.has('aiAgentMonitoring') ? 'blur(3px)' : 'none'
                            }}>
                                <div style={{ fontSize: '13px', fontWeight: '600', color: '#E63946', marginBottom: '4px' }}>
                                    🔴 No NHI Governance: 8
                                </div>
                                <div style={{ fontSize: '11px', color: '#94a3b8' }}>
                                    Top Risk: "sales-bot" using CEO's API key
                                </div>
                            </div>
                            
                            <button 
                                className="action-button" 
                                onClick={() => unlockedFeatures.has('aiAgentMonitoring') ? handleCompleteTask('Created NHI for sales-bot agent', 0.4) : handlePremiumFeature('aiAgentMonitoring')}
                            >
                                {unlockedFeatures.has('aiAgentMonitoring') ? '🤖 Auto-Onboard Unmanaged Agents' : '🔒 Unlock AI Agent Monitoring'}
                            </button>
                        </div>

                        <div className="card">
                            <div className="card-title">📋 Recent NHI Changes</div>
                            <div style={{ 
                                maxHeight: '340px', 
                                overflowY: 'auto'
                            }}>
                                <div style={{ display: 'grid', gap: '8px' }}>
                                    <div style={{ 
                                        padding: '10px', 
                                        background: 'rgba(0, 196, 140, 0.1)', 
                                        border: '1px solid #00C48C', 
                                        borderRadius: '6px' 
                                    }}>
                                        <div style={{ fontSize: '12px', fontWeight: '600', color: '#00C48C', marginBottom: '4px' }}>
                                            ✅ Credential Rotated
                                        </div>
                                        <div style={{ fontSize: '11px', color: '#e2e8f0', marginBottom: '4px' }}>
                                            aws-prod-db-svc rotated successfully
                                        </div>
                                        <div style={{ fontSize: '10px', color: '#64748b' }}>
                                            2 minutes ago
                                        </div>
                                    </div>
                                    
                                    <div style={{ 
                                        padding: '10px', 
                                        background: 'rgba(0, 188, 212, 0.1)', 
                                        border: '1px solid #00BCD4', 
                                        borderRadius: '6px' 
                                    }}>
                                        <div style={{ fontSize: '12px', fontWeight: '600', color: '#00BCD4', marginBottom: '4px' }}>
                                            🆕 New NHI Created
                                        </div>
                                        <div style={{ fontSize: '11px', color: '#e2e8f0', marginBottom: '4px' }}>
                                            jenkins-pipeline-prod
                                        </div>
                                        <div style={{ fontSize: '10px', color: '#64748b' }}>
                                            15 minutes ago
                                        </div>
                                    </div>
                                    
                                    <div style={{ 
                                        padding: '10px', 
                                        background: 'rgba(255, 107, 53, 0.1)', 
                                        border: '1px solid #FF6B35', 
                                        borderRadius: '6px' 
                                    }}>
                                        <div style={{ fontSize: '12px', fontWeight: '600', color: '#FF6B35', marginBottom: '4px' }}>
                                            ⚠️ Access Granted
                                        </div>
                                        <div style={{ fontSize: '11px', color: '#e2e8f0', marginBottom: '4px' }}>
                                            api-gateway-svc → S3 bucket access
                                        </div>
                                        <div style={{ fontSize: '10px', color: '#64748b' }}>
                                            1 hour ago
                                        </div>
                                    </div>
                                    
                                    <div style={{ 
                                        padding: '10px', 
                                        background: 'rgba(0, 196, 140, 0.1)', 
                                        border: '1px solid #00C48C', 
                                        borderRadius: '6px' 
                                    }}>
                                        <div style={{ fontSize: '12px', fontWeight: '600', color: '#00C48C', marginBottom: '4px' }}>
                                            ✅ Certificate Renewed
                                        </div>
                                        <div style={{ fontSize: '11px', color: '#e2e8f0', marginBottom: '4px' }}>
                                            *.api.company.com SSL cert
                                        </div>
                                        <div style={{ fontSize: '10px', color: '#64748b' }}>
                                            2 hours ago
                                        </div>
                                    </div>
                                    
                                    <div style={{ 
                                        padding: '10px', 
                                        background: 'rgba(0, 188, 212, 0.1)', 
                                        border: '1px solid #00BCD4', 
                                        borderRadius: '6px' 
                                    }}>
                                        <div style={{ fontSize: '12px', fontWeight: '600', color: '#00BCD4', marginBottom: '4px' }}>
                                            🔄 Access Revoked
                                        </div>
                                        <div style={{ fontSize: '11px', color: '#e2e8f0', marginBottom: '4px' }}>
                                            old-ci-runner → production DB
                                        </div>
                                        <div style={{ fontSize: '10px', color: '#64748b' }}>
                                            3 hours ago
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div style={{ marginTop: '12px', textAlign: 'center' }}>
                                <button className="action-button secondary" style={{ width: '100%' }}>
                                    View Full Activity Log
                                </button>
                            </div>
                        </div>

                        <div className="card">
                            <div className="card-title">🚨 System Health Alerts</div>
                            <div style={{ marginBottom: '16px' }}>
                                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                                    <span style={{ color: '#94a3b8', fontSize: '14px' }}>Active Alerts</span>
                                    <span style={{ color: '#E63946', fontSize: '20px', fontWeight: 'bold' }}>8</span>
                                </div>
                            </div>
                            
                            <div style={{ display: 'grid', gap: '8px' }}>
                                <div style={{ 
                                    padding: '12px', 
                                    background: 'rgba(230, 57, 70, 0.1)', 
                                    border: '1px solid #E63946', 
                                    borderRadius: '6px' 
                                }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>
                                        <span style={{ fontSize: '12px', fontWeight: '600', color: '#E63946' }}>
                                            🔴 Connection Failed
                                        </span>
                                        <span style={{ fontSize: '10px', color: '#64748b' }}>Just now</span>
                                    </div>
                                    <div style={{ fontSize: '11px', color: '#e2e8f0' }}>
                                        Oracle DB connection timeout (3 retries)
                                    </div>
                                </div>
                                
                                <div style={{ 
                                    padding: '12px', 
                                    background: 'rgba(230, 57, 70, 0.1)', 
                                    border: '1px solid #E63946', 
                                    borderRadius: '6px' 
                                }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>
                                        <span style={{ fontSize: '12px', fontWeight: '600', color: '#E63946' }}>
                                            🔴 Certificate Expiring
                                        </span>
                                        <span style={{ fontSize: '10px', color: '#64748b' }}>5 min ago</span>
                                    </div>
                                    <div style={{ fontSize: '11px', color: '#e2e8f0' }}>
                                        payment-gateway cert expires in 6 days
                                    </div>
                                </div>
                                
                                <div style={{ 
                                    padding: '12px', 
                                    background: 'rgba(255, 107, 53, 0.1)', 
                                    border: '1px solid #FF6B35', 
                                    borderRadius: '6px' 
                                }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>
                                        <span style={{ fontSize: '12px', fontWeight: '600', color: '#FF6B35' }}>
                                            🟡 Rotation Delayed
                                        </span>
                                        <span style={{ fontSize: '10px', color: '#64748b' }}>15 min ago</span>
                                    </div>
                                    <div style={{ fontSize: '11px', color: '#e2e8f0' }}>
                                        azure-storage-key rotation overdue by 2 days
                                    </div>
                                </div>
                                
                                <div style={{ 
                                    padding: '12px', 
                                    background: 'rgba(255, 107, 53, 0.1)', 
                                    border: '1px solid #FF6B35', 
                                    borderRadius: '6px' 
                                }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>
                                        <span style={{ fontSize: '12px', fontWeight: '600', color: '#FF6B35' }}>
                                            🟡 High Usage Detected
                                        </span>
                                        <span style={{ fontSize: '10px', color: '#64748b' }}>1 hour ago</span>
                                    </div>
                                    <div style={{ fontSize: '11px', color: '#e2e8f0' }}>
                                        api-worker NHI: 847% above baseline
                                    </div>
                                </div>
                            </div>
                            
                            <div style={{ marginTop: '12px' }}>
                                <button className="action-button" style={{ width: '100%' }}>
                                    Acknowledge All Alerts
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="grid">
                        <div className="card">
                            <div className="card-title">🔄 Rotation Efficiency</div>
                            <div style={{ fontSize: '14px', color: '#94a3b8', marginBottom: '8px' }}>
                                This Week's Progress
                            </div>
                            <div className="progress-bar">
                                <div className="progress-fill" style={{ width: `${rotationProgress}%` }}>
                                    {rotationProgress}/100
                                </div>
                            </div>
                            <div style={{ marginTop: '16px', display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '12px' }}>
                                <div>
                                    <div style={{ fontSize: '11px', color: '#94a3b8' }}>Completed</div>
                                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#00C48C' }}>52</div>
                                </div>
                                <div>
                                    <div style={{ fontSize: '11px', color: '#94a3b8' }}>Failed</div>
                                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#E63946' }}>3</div>
                                </div>
                                <div>
                                    <div style={{ fontSize: '11px', color: '#94a3b8' }}>Remaining</div>
                                    <div style={{ fontSize: '20px', fontWeight: 'bold', color: '#fff' }}>48</div>
                                </div>
                            </div>
                            <button 
                                className="action-button" 
                                style={{ marginTop: '16px' }}
                                onClick={() => {
                                    setRotationProgress(prev => Math.min(100, prev + 10));
                                    handleCompleteTask('Rotated 10 credentials', 0.3);
                                }}
                            >
                                Process Next Batch
                            </button>
                        </div>

                        <div className="card">
                            <div className="card-title">🔗 System Integration Status</div>
                            <div style={{ display: 'grid', gap: '8px' }}>
                                <div className="system-status-item">
                                    <div className="system-status-indicator healthy"></div>
                                    <div style={{ flex: 1 }}>
                                        <div style={{ fontSize: '13px', fontWeight: '600', color: '#fff' }}>Active Directory</div>
                                        <div style={{ fontSize: '11px', color: '#94a3b8' }}>Connected • Sync: 2 min ago</div>
                                    </div>
                                </div>
                                
                                <div className="system-status-item">
                                    <div className="system-status-indicator healthy"></div>
                                    <div style={{ flex: 1 }}>
                                        <div style={{ fontSize: '13px', fontWeight: '600', color: '#fff' }}>AWS</div>
                                        <div style={{ fontSize: '11px', color: '#94a3b8' }}>Healthy • 847 resources</div>
                                    </div>
                                </div>
                                
                                <div className="system-status-item">
                                    <div className="system-status-indicator warning"></div>
                                    <div style={{ flex: 1 }}>
                                        <div style={{ fontSize: '13px', fontWeight: '600', color: '#fff' }}>GCP</div>
                                        <div style={{ fontSize: '11px', color: '#FF6B35' }}>API Rate Limited</div>
                                    </div>
                                </div>
                                
                                <div className="system-status-item">
                                    <div className="system-status-indicator error"></div>
                                    <div style={{ flex: 1 }}>
                                        <div style={{ fontSize: '13px', fontWeight: '600', color: '#fff' }}>Oracle DB</div>
                                        <div style={{ fontSize: '11px', color: '#E63946' }}>Connection Failed</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {assignedTasks.length > 0 && (
                        <div className="card">
                            <div className="card-title">📋 Tasks Assigned by CISO</div>
                            <div style={{ display: 'grid', gap: '12px' }}>
                                {assignedTasks.map((task, idx) => (
                                    <div key={idx} style={{
                                        padding: '16px',
                                        background: 'rgba(0, 188, 212, 0.1)',
                                        border: '1px solid #00BCD4',
                                        borderRadius: '8px'
                                    }}>
                                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#fff', marginBottom: '8px' }}>
                                            {task.title}
                                        </div>
                                        <div style={{ fontSize: '12px', color: '#94a3b8', marginBottom: '12px' }}>
                                            Priority: <span style={{ color: '#E63946' }}>{task.priority}</span> | 
                                            Effort: {task.effort}
                                        </div>
                                        <button 
                                            className="action-button"
                                            onClick={() => handleCompleteTask(task.title, task.riskReduction)}
                                        >
                                            Complete Task
                                        </button>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                    
                    <div className="card">
                        <div className="card-title">
                            🚨 Anomalous Access Detected 
                            <span style={{ marginLeft: '8px', fontSize: '14px', color: '#E63946', fontWeight: 'bold' }}>LIVE 🔴</span>
                        </div>
                        <div style={{ marginBottom: '16px' }}>
                            <div style={{ fontSize: '14px', color: '#94a3b8', marginBottom: '8px' }}>
                                <strong style={{ color: '#E63946', fontSize: '20px' }}>47</strong> suspicious access attempts require investigation
                            </div>
                        </div>
                        
                        <div style={{ 
                            maxHeight: '300px', 
                            overflowY: 'auto',
                            marginBottom: '16px'
                        }}>
                            {currentAnomalies.slice(0, 5).map((anomaly) => (
                                <div key={anomaly.id} style={{
                                    padding: '12px',
                                    background: anomaly.severity === 'critical' ? 'rgba(230, 57, 70, 0.1)' : 
                                               anomaly.severity === 'high' ? 'rgba(255, 107, 53, 0.1)' : 
                                               'rgba(0, 188, 212, 0.1)',
                                    border: `1px solid ${anomaly.severity === 'critical' ? '#E63946' : 
                                                           anomaly.severity === 'high' ? '#FF6B35' : '#00BCD4'}`,
                                    borderRadius: '8px',
                                    marginBottom: '8px'
                                }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '8px' }}>
                                        <span className={`status-badge ${anomaly.severity}`}>
                                            {anomaly.severity.toUpperCase()}
                                        </span>
                                        <span style={{ fontSize: '11px', color: '#64748b' }}>{anomaly.time}</span>
                                    </div>
                                    <div style={{ fontSize: '13px', fontWeight: '600', color: '#fff', marginBottom: '4px' }}>
                                        {anomaly.resource}
                                    </div>
                                    <div style={{ fontSize: '12px', color: '#94a3b8', marginBottom: '4px' }}>
                                        {anomaly.accessor}
                                    </div>
                                    <div style={{ fontSize: '12px', color: '#e2e8f0', marginBottom: '4px' }}>
                                        {anomaly.anomaly}
                                    </div>
                                    {actedAnomalies[anomaly.id] ? (
                                        <div style={{ 
                                            display: 'flex', 
                                            alignItems: 'center', 
                                            gap: '8px', 
                                            marginTop: '8px',
                                            padding: '8px',
                                            background: 'rgba(0, 196, 140, 0.15)',
                                            borderRadius: '6px'
                                        }}>
                                            <span style={{ fontSize: '16px' }}>
                                                {actedAnomalies[anomaly.id] === 'investigate' ? '🔍' : '🚫'}
                                            </span>
                                            <span style={{ fontSize: '12px', fontWeight: '600', color: '#00C48C' }}>
                                                {actedAnomalies[anomaly.id] === 'investigate' ? 'Investigation In Progress' : 'Blocked Successfully'}
                                            </span>
                                        </div>
                                    ) : (
                                        <div style={{ display: 'flex', gap: '8px', marginTop: '8px' }}>
                                            <button 
                                                className="action-button secondary"
                                                style={{ flex: 1, padding: '6px 12px', fontSize: '12px' }}
                                                onClick={() => handleCompleteTask(`Investigated ${anomaly.resource}`, 0.1, anomaly.id, 'investigate')}
                                            >
                                                Investigate
                                            </button>
                                            <button 
                                                className="action-button danger"
                                                style={{ flex: 1, padding: '6px 12px', fontSize: '12px' }}
                                                onClick={() => handleCompleteTask(`Blocked ${anomaly.accessor}`, 0.2, anomaly.id, 'block')}
                                            >
                                                Block
                                            </button>
                                        </div>
                                    )}
                                </div>
                            ))}
                            {currentAnomalies.length > 5 && (
                                <div style={{ textAlign: 'center', padding: '12px', color: '#64748b', fontSize: '13px' }}>
                                    ... {currentAnomalies.length - 5} more anomalies
                                </div>
                            )}
                        </div>
                        
                        <div style={{ fontSize: '12px', color: '#94a3b8', textAlign: 'center', marginBottom: '12px' }}>
                            💡 Tip: Enable Automatic Access Control in CISO view to auto-block threats
                        </div>
                    </div>

                    {completedTasks.length > 0 && (
                        <div className="card">
                            <div className="card-title">✅ Recently Completed</div>
                            <div style={{ display: 'grid', gap: '8px' }}>
                                {completedTasks.slice(0, 5).map((task, idx) => (
                                    <div key={idx} className="ciso-feed-item">
                                        <div><strong>{task.action}</strong> {task.description}</div>
                                        <div className="timestamp">{task.timestamp}</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
                
                {showPremiumModal && selectedPremiumFeature && (
                    <PremiumFeatureModal 
                        feature={selectedPremiumFeature}
                        onClose={() => {
                            setShowPremiumModal(false);
                            setSelectedPremiumFeature(null);
                        }}
                        onProceed={handleProceedPremium}
                    />
                )}
                
                {toasts.map(toast => (
                    <ToastNotification
                        key={toast.id}
                        message={toast.message}
                        type={toast.type}
                        onClose={() => removeToast(toast.id)}
                    />
                ))}
            </>
            );
        }

        // Main App Component
        function App() {
            const [currentPersona, setCurrentPersona] = useState(null);
            const [cisoFeed, setCisoFeed] = useState([]);
            const [assignedTasks, setAssignedTasks] = useState([]);
            const [assignedTaskIds, setAssignedTaskIds] = useState(new Set());
            const [completedTaskReductions, setCompletedTaskReductions] = useState(0);

            const handleTaskComplete = (task) => {
                setCisoFeed([task, ...cisoFeed]);
                // Remove completed task from assigned tasks
                setAssignedTasks(prev => prev.filter(t => t.title !== task.description));
                // Add risk reduction to total
                if (task.riskReduction) {
                    setCompletedTaskReductions(prev => prev + task.riskReduction);
                }
            };

            const handleAssignPriority = (recommendation) => {
                setAssignedTasks([...assignedTasks, recommendation]);
                setAssignedTaskIds(new Set([...assignedTaskIds, recommendation.id]));
            };

            if (!currentPersona) {
                return <PersonaSelector onSelectPersona={setCurrentPersona} />;
            }

            if (currentPersona === 'ciso') {
                return (
                    <CISODashboard 
                        onSwitchPersona={() => setCurrentPersona('itadmin')}
                        cisoFeed={cisoFeed}
                        onAssignPriority={handleAssignPriority}
                        assignedTaskIds={assignedTaskIds}
                        completedTaskReductions={completedTaskReductions}
                    />
                );
            }

            return (
                <ITAdminDashboard 
                    onSwitchPersona={() => setCurrentPersona('ciso')}
                    onTaskComplete={handleTaskComplete}
                    assignedTasks={assignedTasks}
                />
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>